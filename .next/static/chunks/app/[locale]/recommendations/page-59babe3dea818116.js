(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[136],{5531:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var r=s(2265);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),i=e=>{let t=a(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...m},u)=>(0,r.createElement)("svg",{ref:u,...d,width:t,height:t,stroke:e,strokeWidth:n?24*Number(s)/Number(t):s,className:l("lucide",a),...!i&&!c(m)&&{"aria-hidden":"true"},...m},[...o.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),m=(e,t)=>{let s=(0,r.forwardRef)(({className:s,...a},c)=>(0,r.createElement)(o,{ref:c,iconNode:t,className:l(`lucide-${n(i(e))}`,`lucide-${e}`,s),...a}));return s.displayName=i(e),s}},8063:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(5531).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},4530:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(5531).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5790:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(5531).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},1702:function(e,t,s){Promise.resolve().then(s.bind(s,2709))},2709:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return X}});var r=s(7437),n=s(2265),a=s(5967),i=s(4033),l=s(5996),c=s(7307),d=s(826);async function o(e){let t=await fetch("".concat(d.T5,"/api/shopify/apply-price"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).detail||"Fehler beim Anwenden des Preises");return t.json()}var m=s(5531);let u=(0,m.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),h=(0,m.Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),x=(0,m.Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var g=s(8292);function p(e,t){return(...e)=>{try{return t(...e)}catch{throw Error(void 0)}}}let b=p(0,g.T_);p(0,g.Gb);var f=s(4530),j=s(8063);let y=(0,m.Z)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),v=(0,m.Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function N(e){let{confidence:t,reasoning:s,compact:n=!1,confidenceBasis:a}=e,i=b("confidence"),l=t>1?t:100*t,c={high:{icon:f.Z,color:"green",bgColor:"bg-gradient-to-r from-green-50 to-emerald-50",borderColor:"border-green-200",textColor:"text-green-700",barColor:"bg-green-500",gradientBar:"bg-gradient-to-r from-green-500 to-emerald-600"},medium:{icon:j.Z,color:"yellow",bgColor:"bg-gradient-to-r from-yellow-50 to-amber-50",borderColor:"border-yellow-200",textColor:"text-yellow-700",barColor:"bg-yellow-500",gradientBar:"bg-gradient-to-r from-yellow-500 to-amber-600"},low:{icon:y,color:"red",bgColor:"bg-gradient-to-r from-red-50 to-orange-50",borderColor:"border-red-200",textColor:"text-red-700",barColor:"bg-red-500",gradientBar:"bg-gradient-to-r from-red-500 to-orange-600"}}[l>=85?"high":l>=60?"medium":"low"],d=c.icon;if(n)return(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border ".concat(c.bgColor," ").concat(c.borderColor),children:[(0,r.jsx)(d,{className:"w-4 h-4 ".concat(c.textColor)}),(0,r.jsxs)("span",{className:"text-sm font-semibold ".concat(c.textColor),children:[l.toFixed(0),"%"]})]});let o=(null==a?void 0:a.competitor_count)||0;return null==a||a.sales_30d,(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-2xl border-l-4 border-blue-500 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-blue-500 rounded-2xl flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(v,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:i("title",{confidence:l.toFixed(0)})}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(l,"%")}})})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-white/50 rounded-xl border",children:[(0,r.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:["\uD83D\uDCCA ",(0,r.jsx)("span",{children:i("whatAnalyzes")})]}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-gray-700",children:[(0,r.jsx)("li",{children:"• Echte Verkaufsdaten aus deinem Shopify-Shop"}),(0,r.jsxs)("li",{children:["• Aktuelle Preise deiner ",o>0?"".concat(o,"-").concat(Math.max(o,10)):"5-10"," wichtigsten Konkurrenten"]}),(0,r.jsxs)("li",{children:["• ",(null==a?void 0:a.ml_models)||4," spezialisierte Machine-Learning-Modelle (Umsatz, Konkurrenz, Marge, Saisonalit\xe4t)"]}),(0,r.jsx)("li",{children:"• Deine eingetragenen Kosten und bisherigen Margen"})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-yellow-50/80 border border-yellow-200 rounded-xl",children:[(0,r.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:["\uD83D\uDCA1 ",i("why",{confidence:l.toFixed(0)})]}),(0,r.jsx)("p",{className:"text-sm text-gray-800 leading-relaxed",children:i("whyText")})]})]})}let w=(0,m.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),_=(0,m.Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EUR";return new Intl.NumberFormat("de-DE",{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function D(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"".concat(e>=0?"+":"").concat(e.toFixed(t),"%")}function C(e){var t,s;let{recommendedPrice:a,onApply:i,onDismiss:l,isApplying:c,isDisabled:d=!1,marginAnalysis:o}=e,m=b("pricing"),x=b("common"),g=b("actions"),[p,f]=(0,n.useState)(!1),j=o&&!o.is_safe,y=(null==o?void 0:null===(s=o.details)||void 0===s?void 0:null===(t=s.margin)||void 0===t?void 0:t.euro)?30*o.details.margin.euro:null;return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsx)("button",{onClick:i,disabled:c||d,className:"\n            flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-semibold\n            transition-all duration-200 transform hover:scale-105\n            disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\n            ".concat(d?"bg-gray-300 text-gray-600":j?"bg-orange-600 hover:bg-orange-700 text-white shadow-lg hover:shadow-xl":"bg-green-600 hover:bg-green-700 text-white shadow-lg hover:shadow-xl","\n          "),children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:m("applying")})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w,{className:"w-5 h-5"}),(0,r.jsxs)("div",{className:"flex flex-col items-start",children:[(0,r.jsx)("span",{children:m("apply_price",{price:k(a)})}),y&&(0,r.jsxs)("span",{className:"text-xs opacity-80 font-normal",children:["+",k(y),g("month_est")]})]})]})}),(0,r.jsxs)("button",{onClick:l,disabled:c,className:"flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-semibold border-2 border-gray-300 text-gray-700 hover:bg-gray-50 transition-all disabled:opacity-50",children:[(0,r.jsx)(_,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:x("dismiss")})]})]}),(0,r.jsxs)("button",{onClick:()=>f(!p),className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,r.jsx)(h,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:m("schedule_later")})]}),p&&(0,r.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200 space-y-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-900",children:g("schedule_price_change")}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-blue-700 mb-1",children:g("date")}),(0,r.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-blue-300 rounded-lg text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-blue-700 mb-1",children:g("time")}),(0,r.jsx)("input",{type:"time",defaultValue:"09:00",className:"w-full px-3 py-2 border border-blue-300 rounded-lg text-sm"})]})]}),(0,r.jsx)("button",{className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:g("schedule_change")})]}),d&&(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,r.jsx)(_,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,r.jsx)("p",{className:"text-sm text-red-800",children:g("cannot_apply_warning")})]}),j&&!d&&(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,r.jsx)(u,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-orange-900 mb-1",children:g("margin_warning")}),(0,r.jsx)("p",{className:"text-xs text-orange-800",children:null==o?void 0:o.message})]})]})]})}function P(e){let{recommendedPrice:t,currentPrice:s,strategyDetails:n=[],competitorData:a}=e,i=e=>{let t=100*e;return t>=90?(0,r.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium border border-green-200",children:"✅ Datenqualit\xe4t: Exzellent"}):t>=80?(0,r.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium border border-green-200",children:"✅ Datenqualit\xe4t: Sehr gut"}):t>=70?(0,r.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs font-medium border border-yellow-200",children:"⚠️ Datenqualit\xe4t: Gut"}):t>=60?(0,r.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-700 rounded text-xs font-medium border border-orange-200",children:"⚠️ Datenqualit\xe4t: Ausreichend"}):(0,r.jsx)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium border border-red-200",children:"⚠️ Datenqualit\xe4t: Begrenzt"})},l={competitive:{emoji:"\uD83C\uDFEA",title:"Du bist teurer als der Markt",getStory:e=>{var r,n,a;let i=(null===(r=e.competitorData)||void 0===r?void 0:r.avg)||0,l=(null===(a=e.competitorData)||void 0===a?void 0:null===(n=a.prices)||void 0===n?void 0:n.length)||5,c=s-i,d=(c/i*100).toFixed(0),o=t-i;return c>0?"Wir haben ".concat(l," Wettbewerber analysiert. Der durchschnittliche Preis liegt bei ").concat(k(i),". Du bist ").concat(d,"% teurer als der Durchschnitt. Du solltest ").concat(k(Math.abs(o))," ").concat(o<0?"senken":"erh\xf6hen"," um wettbewerbsf\xe4hig zu bleiben."):"Wir haben ".concat(l," Wettbewerber analysiert. Der durchschnittliche Preis liegt bei ").concat(k(i),". Du bist bereits wettbewerbsf\xe4hig positioniert.")},getBasedOn:e=>{var t,r,n;let a=(null===(r=e.competitorData)||void 0===r?void 0:null===(t=r.prices)||void 0===t?void 0:t.length)||5,i=(null===(n=e.competitorData)||void 0===n?void 0:n.avg)||0,l=i>0?((s-i)/i*100).toFixed(0):"0",c=s>i?"".concat(l,"% \xfcber"):"".concat(Math.abs(Number(l)),"% unter");return["Echtzeitpreise von ".concat(a," Konkurrenten"),"Aktuelle Marktdaten (heute aktualisiert)","Deine Position: ".concat(c," Durchschnitt")]}},demand:{emoji:"\uD83D\uDCC8",title:"Die Nachfrage steigt stark",getStory:e=>{let t=e.sales||64,s=e.previousSales||54,r=s>0?((t-s)/s*100).toFixed(0):"19";return"In den letzten 7 Tagen hast du ".concat(t," Verk\xe4ufe gemacht (vorher: ").concat(s," Verk\xe4ufe). Das ist ein +").concat(r,"% Wachstum! Wenn die Nachfrage steigt, kannst du h\xf6here Preise durchsetzen.")},getBasedOn:e=>["Deine letzten 30 Tage Verkaufsdaten","Trendanalyse der letzten Woche","Machine-Learning Vorhersage f\xfcr n\xe4chste 7 Tage"]},inventory:{emoji:"\uD83D\uDCE6",title:"Dein Lagerbestand ist niedrig",getStory:e=>{let t=e.stock||45,s=e.daysOfStock||20;return"Mit ".concat(t," Einheiten auf Lager hast du bei aktuellem Tempo noch ").concat(s," Tage Vorrat. Das ist knapp! Du solltest vorsichtig mit Preissenkungen sein.")},getBasedOn:e=>{let t=e.stock||45,s=e.avgDaily||2.25;return["Aktueller Lagerbestand: ".concat(t," St\xfcck"),"Durchschnittlicher Verkauf: ".concat(s.toFixed(1),"/Tag"),"Berechnung basierend auf letzten 7 Tagen Verk\xe4ufen"]}},cost:{emoji:"\uD83D\uDCB0",title:"Deine Kosten sind stabil",getStory:e=>"Deine Einkaufskosten liegen bei einem stabilen Niveau. Die empfohlene Preis\xe4nderung ber\xfccksichtigt deine aktuellen Margen und stellt sicher, dass du profitabel bleibst.",getBasedOn:e=>["Deine hinterlegten Produktkosten","Aktuelle Marge-Berechnung","Historische Kostenentwicklung"]}},c=e=>{let t=e.recommended_price-s;return{value:t,formatted:k(Math.abs(t)),isIncrease:t>0,isDecrease:t<0}},d=[...n].sort((e,t)=>{let s=Math.abs(c(e).value);return Math.abs(c(t).value)-s}),o=t-s,m=o<0;return(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDCA1"}),(0,r.jsxs)("span",{children:["Warum empfehlen wir ",k(t),"?"]})]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Unsere KI hat ",n.length," wichtige Marktfaktoren analysiert:"]})]}),(0,r.jsx)("div",{className:"space-y-4 mb-6",children:d.map((e,n)=>{let d=l[e.strategy]||{emoji:"\uD83D\uDCCA",title:e.strategy,getStory:()=>e.reasoning||"Keine Details verf\xfcgbar.",getBasedOn:()=>["Daten aus KI-Analyse"]},o=c(e);return(0,r.jsxs)("div",{className:"border-2 border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:n+1+"️⃣"}),(0,r.jsx)("span",{className:"text-2xl",children:d.emoji}),(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:d.title})]}),i(e.confidence)]}),(0,r.jsx)("p",{className:"text-gray-700 mb-3 leading-relaxed",children:d.getStory({competitorData:a,currentPrice:s,recommendedPrice:t,strategy:e})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 p-2 rounded ".concat(o.isDecrease?"bg-red-50":o.isIncrease?"bg-green-50":"bg-gray-50"),children:[(0,r.jsx)("span",{className:"text-xl",children:"\uD83D\uDCB0"}),(0,r.jsxs)("span",{className:"font-semibold ".concat(o.isDecrease?"text-red-600":o.isIncrease?"text-green-600":"text-gray-600"),children:["Preisimpact: ",o.isDecrease?"-":o.isIncrease?"+":"",o.formatted," ",o.isDecrease?"Senkung empfohlen":o.isIncrease?"Erh\xf6hung empfohlen":"Keine \xc4nderung"]})]}),(0,r.jsxs)("details",{className:"mt-2",children:[(0,r.jsxs)("summary",{className:"cursor-pointer text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-2",children:[(0,r.jsx)("span",{children:"ℹ️"}),(0,r.jsx)("span",{children:"Basiert auf..."})]}),(0,r.jsx)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:(0,r.jsx)("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-700",children:d.getBasedOn({competitorData:a,strategy:e,currentPrice:s}).map((e,t)=>(0,r.jsx)("li",{children:e},t))})})]})]},n)})}),(0,r.jsxs)("div",{className:"mt-6 p-4 rounded-lg border-2 ".concat(m?"bg-red-50 border-red-300":o>0?"bg-green-50 border-green-300":"bg-gray-50 border-gray-300"),children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"Gesamt-Effekt:"}),(0,r.jsxs)("p",{className:"text-gray-700 mb-2",children:["Die Analyse zeigt, dass eine Preis",m?"senkung":o>0?"erh\xf6hung":"\xe4nderung"," um ",k(Math.abs(o))," ",m?"sinnvoll w\xe4re um wettbewerbsf\xe4hig zu bleiben":o>0?"sinnvoll w\xe4re um die Marge zu optimieren":"nicht empfohlen wird","."]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-300",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Berechnung:"}),(0,r.jsxs)("span",{className:"font-mono font-semibold text-gray-900",children:[k(s)," ",m?"-":"+"," ",k(Math.abs(o))," = ",k(t)]})]})]})]})}function S(e){var t,s;let{recommendation:a,onApply:i,onDismiss:l,onRefresh:c}=e,d=b("pricing"),o=b("common");b("market");let[m,g]=(0,n.useState)(!1),[p,f]=(0,n.useState)(!1),j=a.recommended_price,y=j-a.current_price,v=y/a.current_price*100,w=y>0,_=0===y,S=a.margin_analysis&&!a.margin_analysis.is_safe,M=null===(t=a.warnings)||void 0===t?void 0:t.some(e=>"HIGH"===e.severity||"high"===e.severity),A=function(e){var t;let s=e.recommended_price-e.current_price,r=Math.abs(e.price_change_pct),n=(t=s<0,"Empfohlene ".concat(t?"Preissenkung":"Preiserh\xf6hung"," um ").concat(r.toFixed(1),"%, ").concat(t?"um wettbewerbsf\xe4hig zu bleiben":"aufgrund gestiegener Nachfrage","."));return{headline:n,bulletPoints:function(e){var t,s,r,n;let a=[];if(e.competitor_context){let t=e.competitor_context,s={most_expensive:"Teuerste Option",above_average:"\xdcber dem Durchschnitt",average:"Marktdurchschnitt",below_average:"Unter dem Durchschnitt",cheapest:"G\xfcnstigste Option",unknown:"Unbekannt"}[t.position]||"Unbekannt",r=t.price_diff_pct>0?"".concat(t.price_diff_pct.toFixed(1),"% \xfcber"):"".concat(Math.abs(t.price_diff_pct).toFixed(1),"% unter");a.push("Du liegst aktuell ".concat(r," dem durchschnittlichen Marktpreis (").concat((n=t.avg_price,new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format(n)),").")),"unknown"!==s&&a.push("Deine Position: ".concat(s," (").concat(t.competitor_count," Wettbewerber analysiert)."))}if(null===(t=e.strategies)||void 0===t?void 0:t.inventory){let t=e.strategies.inventory;if(t.reasoning.includes("Normaler Bestand")||t.reasoning.includes("normal")){let e=t.reasoning.match(/\((\d+)\)/),s=e?e[1]:"";a.push("Dein Bestand ist normal".concat(s?" (".concat(s," St\xfcck)"):""," – es besteht kein akuter Abverkaufsdruck."))}else t.reasoning.includes("Hoher Bestand")||t.reasoning.includes("hoch")?a.push("Dein Bestand ist hoch – eine Preissenkung k\xf6nnte den Absatz ankurbeln."):(t.reasoning.includes("Niedriger Bestand")||t.reasoning.includes("niedrig"))&&a.push("Dein Bestand ist niedrig – du k\xf6nntest den Preis erh\xf6hen, ohne Absatz zu verlieren.")}if(null===(s=e.strategies)||void 0===s?void 0:s.cost){let t=e.strategies.cost.reasoning.match(/(\d+)%/i),s=t?t[1]:"30";a.push("Die empfohlene Anpassung h\xe4lt deine Zielmarge von ca. ".concat(s,"% ein."))}if(e.margin&&(e.margin.is_safe&&e.margin.margin_pct>=20?a.push("Deine Marge bleibt mit ".concat(e.margin.margin_pct.toFixed(1),"% auf einem gesunden Niveau.")):e.margin.margin_pct<20&&a.push("Achtung: Deine Marge liegt bei ".concat(e.margin.margin_pct.toFixed(1),"% – unter dem empfohlenen Minimum von 20%."))),null===(r=e.strategies)||void 0===r?void 0:r.demand){let t=e.strategies.demand;t.confidence>.6&&!t.reasoning.includes("Zu wenig Daten")&&(t.reasoning.includes("wachsend")||t.reasoning.includes("steigend")?a.push("Die Nachfrage zeigt einen positiven Trend – eine moderate Preiserh\xf6hung k\xf6nnte m\xf6glich sein."):(t.reasoning.includes("r\xfcckl\xe4ufig")||t.reasoning.includes("sinkend"))&&a.push("Die Nachfrage ist r\xfcckl\xe4ufig – eine Preissenkung k\xf6nnte den Absatz stabilisieren."))}return a.length<2&&(a.push("Die Empfehlung basiert auf einer Analyse deiner aktuellen Preislage und Marktvergleichen."),a.push("Der empfohlene Preis optimiert deine Wettbewerbsposition bei gleichbleibender Profitabilit\xe4t.")),a.slice(0,5)}(e),confidence:function(e){var t,s,r;let n=(100*e.confidence).toFixed(1),a=(null===(t=e.ml_predictions)||void 0===t?void 0:t.combined_ml_confidence)?(100*e.ml_predictions.combined_ml_confidence).toFixed(1):null,i=[];e.confidence>=.8?i.push("Hohe Sicherheit"):e.confidence>=.6?i.push("Moderate Sicherheit"):i.push("Eingeschr\xe4nkte Sicherheit"),i.push("".concat(n,"%"));let l=[];return e.competitor_context&&l.push("Wettbewerbsvergleich"),(null===(s=e.strategies)||void 0===s?void 0:s.cost)&&l.push("Kosten"),(null===(r=e.strategies)||void 0===r?void 0:r.inventory)&&l.push("Bestand"),a&&l.push("historische Daten"),l.length>0&&i.push("basierend auf ".concat(l.join(", "))),a&&parseFloat(a)>90&&i.push("und ML-Vorhersage (".concat(a,"%)")),i.join(": ")+"."}(e),insights:function(e){if(e.has_insights){let t=[];return e.competitor_context&&("most_expensive"===e.competitor_context.position&&e.competitor_context.price_diff_pct>30?t.push("Du bist deutlich teurer als der Markt (".concat(e.competitor_context.price_diff_pct.toFixed(1),"% \xfcber Durchschnitt).")):"cheapest"===e.competitor_context.position&&Math.abs(e.competitor_context.price_diff_pct)>20&&t.push("Du bist deutlich g\xfcnstiger als der Markt – eine moderate Preiserh\xf6hung k\xf6nnte m\xf6glich sein.")),e.margin&&!e.margin.is_safe&&t.push("Achtung: Die empfohlene Preis\xe4nderung w\xfcrde deine Marge auf ".concat(e.margin.margin_pct.toFixed(1),"% reduzieren.")),t.join(" ")||"Aktuell liegen keine besonderen Auff\xe4lligkeiten vor."}return"Aktuell liegen keine besonderen Auff\xe4lligkeiten vor. Die Empfehlung basiert auf Standardmodellen und den aktuellen Marktpreisen."}(e)}}({product_title:a.product_title||a.product_name,product_name:a.product_name,current_price:a.current_price,recommended_price:a.recommended_price,price_change_pct:a.price_change_pct,confidence:a.confidence,strategies:function(e){if(e.strategy_details&&Array.isArray(e.strategy_details)){let t={};return e.strategy_details.forEach(e=>{t[e.strategy]={price:e.recommended_price,confidence:e.confidence,strategy:e.strategy,reasoning:e.reasoning||""}}),t}let t=e.reasoning;if("object"==typeof t&&(null==t?void 0:t.strategies))return t.strategies}(a),competitor_context:function(e){if(e.competitor_data){var t;let s=e.competitor_data,r=e.recommended_price,n="unknown";return s.avg&&(n=r>=.95*s.max?"most_expensive":r<=1.05*s.min?"cheapest":r>1.1*s.avg?"above_average":r<.9*s.avg?"below_average":"average"),{position:n,avg_price:s.avg||0,min_price:s.min||0,max_price:s.max||0,price_diff_pct:s.avg?(r-s.avg)/s.avg*100:0,competitor_count:(null===(t=s.prices)||void 0===t?void 0:t.length)||0}}}(a),ml_predictions:function(e){let t=e.reasoning;if("object"==typeof t&&(null==t?void 0:t.ml_predictions))return t.ml_predictions}(a),margin:a.margin_analysis?{is_safe:a.margin_analysis.is_safe,margin_pct:a.margin_analysis.margin||0}:void 0,has_insights:a.warnings&&a.warnings.length>0});A.confidence;let F=async()=>{if(i){g(!0);try{await i(j)}catch(e){console.error("Failed to apply price:",e)}finally{g(!1)}}},E=async()=>{if(c){f(!0);try{await c()}catch(e){console.error("Failed to refresh:",e)}finally{f(!1)}}},z=a.product_title||a.product_name||"Product ".concat(a.product_id),B=a.generated_at||a.created_at||new Date().toISOString();return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 pb-4 bg-gradient-to-br from-blue-50 to-white",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-1",children:z}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[d("product_id"),": ",a.product_id]})]}),(0,r.jsxs)("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-3 py-1 text-xs font-medium text-emerald-700 border border-emerald-100",children:[Math.round(100*a.confidence),"% ",d("confidence")]})]}),A.headline&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("p",{className:"text-base font-medium text-gray-900",children:A.headline})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8 mb-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1 font-medium",children:d("current")}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:k(a.current_price)})]}),(0,r.jsxs)("div",{className:"rounded-lg p-4 border-2 ".concat(M?"bg-red-50 border-red-300":S?"bg-orange-50 border-orange-300":"bg-green-50 border-green-300"),children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-1 ".concat(M?"text-red-700":S?"text-orange-700":"text-green-700"),children:d("recommended")}),(0,r.jsx)("p",{className:"text-3xl font-bold ".concat(M?"text-red-900":S?"text-orange-900":"text-green-900"),children:k(j)})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-center mb-4",children:_?(0,r.jsx)("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-full",children:(0,r.jsx)("span",{className:"text-gray-600 font-medium",children:d("no_change")})}):(0,r.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full ".concat(w?"bg-blue-100":"bg-orange-100"),children:[(0,r.jsx)("span",{className:"text-2xl",children:w?"\uD83D\uDCC8":"\uD83D\uDCC9"}),(0,r.jsxs)("span",{className:"text-lg font-bold ".concat(w?"text-blue-700":"text-orange-700"),children:[y>0?"+":"",k(y)]}),(0,r.jsxs)("span",{className:"text-lg font-semibold ".concat(w?"text-blue-600":"text-orange-600"),children:["(",v>0?"+":"",D(v),")"]})]})}),(0,r.jsx)("div",{className:"mt-6 px-6",children:(0,r.jsx)(N,{confidence:a.confidence,reasoning:A.confidence,compact:!1,confidenceBasis:a.confidence_basis})}),a.strategy_details&&a.strategy_details.length>0&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border-2 border-blue-300",children:[(0,r.jsxs)("h4",{className:"text-sm font-semibold text-indigo-900 mb-3 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83E\uDDEE"}),"Wie wird ",y>0?"+":"",k(y)," berechnet?"]}),(0,r.jsxs)("p",{className:"text-xs text-indigo-800 mb-4 leading-relaxed",children:["Die Empfehlung ist ein ",(0,r.jsx)("strong",{children:"gewichteter Durchschnitt"}),", NICHT die Summe. Jede Strategie wird mit ihrer ",(0,r.jsx)("strong",{children:"Datenqualit\xe4t gewichtet"}),"."]}),(()=>{let e=e=>{let t=100*e;return t>=90?"Datenqualit\xe4t: Exzellent":t>=80?"Datenqualit\xe4t: Sehr gut":t>=70?"Datenqualit\xe4t: Gut":t>=60?"Datenqualit\xe4t: Ausreichend":"Datenqualit\xe4t: Begrenzt"};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-indigo-900 mb-2",children:"1️⃣ Einzelne Strategien-Empfehlungen:"}),(0,r.jsx)("div",{className:"space-y-1.5",children:a.strategy_details.map((t,s)=>{let n=t.recommended_price-a.current_price;return(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs py-1 px-3 bg-white/60 rounded",children:[(0,r.jsxs)("span",{className:"text-gray-700",children:[{competitive:"\uD83C\uDFEA",demand:"\uD83D\uDCCA",inventory:"\uD83D\uDCE6",cost:"\uD83D\uDCB0"}[t.strategy]||"⚖️"," ",d("strategy_".concat(t.strategy))," (",e(t.confidence),")"]}),(0,r.jsxs)("span",{className:"font-mono font-bold text-gray-900",children:[n>0?"+":"",k(n)]})]},s)})})]}),(0,r.jsxs)("div",{className:"mb-4 p-3 bg-white/80 rounded-lg border border-indigo-200",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-indigo-900 mb-3",children:"2️⃣ Gewichtete Beitr\xe4ge (Datenqualit\xe4t \xd7 Basis-Gewicht):"}),(0,r.jsx)("div",{className:"space-y-2.5",children:a.strategy_details.map((t,s)=>{let n={competitive:.35,demand:.4,inventory:.25,cost:.25},i=n[t.strategy]||.1,l=i*t.confidence/(a.strategy_details||[]).reduce((e,t)=>e+(n[t.strategy]||.1)*t.confidence,0),c=(t.recommended_price-a.current_price)*l;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-[10px] mb-1",children:[(0,r.jsxs)("span",{className:"text-indigo-700 font-medium",children:[d("strategy_".concat(t.strategy)),":"]}),(0,r.jsxs)("span",{className:"font-mono text-indigo-900",children:[(100*i).toFixed(0),"% \xd7 ",e(t.confidence)," =",(0,r.jsxs)("strong",{className:"ml-1 text-indigo-600",children:[(100*l).toFixed(1),"%"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex-1 h-2.5 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-400 to-indigo-600 transition-all duration-500",style:{width:"".concat(100*l,"%")}})}),(0,r.jsxs)("span",{className:"text-xs font-bold text-indigo-900 tabular-nums min-w-[70px] text-right",children:["= ",c>0?"+":"",k(c)]})]})]},s)})})]})]})})(),(0,r.jsxs)("div",{className:"p-4 bg-gradient-to-r from-indigo-100 via-purple-100 to-indigo-100 rounded-xl border-2 border-indigo-400 shadow-sm",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-indigo-900 mb-2",children:"3️⃣ Finale Summe (Gewichteter Durchschnitt):"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-indigo-800 font-medium",children:"Summe aller gewichteten Beitr\xe4ge"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-indigo-900 tabular-nums",children:[y>0?"+":"",k(y)]}),(0,r.jsxs)("div",{className:"text-xs text-indigo-700 mt-1",children:["(",D(v),")"]})]})]})]}),(0,r.jsx)("div",{className:"mt-3 p-3 bg-yellow-50 rounded-lg border border-yellow-300",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-lg flex-shrink-0",children:"\uD83D\uDCA1"}),(0,r.jsxs)("p",{className:"text-xs text-yellow-900 leading-relaxed",children:[(0,r.jsx)("strong",{children:"Warum nicht die einfache Summe?"})," Jede Strategie wird basierend auf ihrer Datenqualit\xe4t unterschiedlich stark gewichtet. Faktoren mit exzellenter Datenqualit\xe4t (z.B. Wettbewerbspreise) haben mehr Einfluss als Faktoren mit guter Datenqualit\xe4t (z.B. Nachfrage-Trends). Die gewichtete Berechnung stellt sicher, dass weniger zuverl\xe4ssige Daten nicht zu starken Einfluss haben."]})]})})]}),a.strategy_details&&a.strategy_details.length>0&&(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(P,{recommendedPrice:j,currentPrice:a.current_price,strategyDetails:a.strategy_details,competitorData:a.competitor_data})}),(i||l)&&(0,r.jsx)(C,{recommendedPrice:j,onApply:F,onDismiss:l||(()=>{}),isApplying:m,isDisabled:M,marginAnalysis:a.margin_analysis})]}),M&&(0,r.jsx)("div",{className:"px-6 py-4 bg-red-50 border-t border-red-200",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(u,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-red-900 mb-1",children:d("critical_warning")}),null===(s=a.warnings)||void 0===s?void 0:s.filter(e=>"HIGH"===e.severity||"high"===e.severity).map((e,t)=>(0,r.jsx)("p",{className:"text-sm text-red-800 mb-2",children:e.message},t))]})]})}),(0,r.jsxs)("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-200 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,r.jsx)(h,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:function(e){let t=new Date,s=new Date(e),r=Math.floor((t.getTime()-s.getTime())/6e4);if(r<1)return"just now";if(1===r)return"1 minute ago";if(r<60)return"".concat(r," minutes ago");let n=Math.floor(r/60);if(1===n)return"1 hour ago";if(n<24)return"".concat(n," hours ago");let a=Math.floor(n/24);return 1===a?"1 day ago":"".concat(a," days ago")}(B)})]}),c&&(0,r.jsxs)("button",{onClick:E,disabled:p,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-50",children:[(0,r.jsx)(x,{className:"w-4 h-4 ".concat(p?"animate-spin":"")}),(0,r.jsx)("span",{children:o("refresh")})]})]})]})}function M(e){let{productId:t,competitorCount:s,salesDataDays:n,onRunAnalysis:a}=e;return(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,r.jsxs)("h3",{className:"font-bold text-xl text-yellow-800 mb-2",children:["⚠️ Erstmalige Analyse f\xfcr Produkt #",t]}),0===s&&(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg border-l-4 border-orange-400 mb-3",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD0D"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Wettbewerbsanalyse l\xe4uft..."}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Wir sammeln gerade Preisdaten von Wettbewerbern f\xfcr dieses Produkt."}),a&&(0,r.jsx)("button",{onClick:a,className:"text-blue-600 underline hover:text-blue-800 text-sm font-medium mt-2",children:"Jetzt sofort analysieren →"})]})]})}),n<7&&(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg border-l-4 border-blue-400",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC8"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Verkaufsdaten werden gesammelt"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Aktuell: ",(0,r.jsxs)("span",{className:"font-semibold",children:[n," Tage"]}),". Optimal: ",(0,r.jsx)("span",{className:"font-semibold text-green-600",children:"30+ Tage"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Mehr Verkaufsdaten f\xfchren zu pr\xe4ziseren Preisempfehlungen."})]})]})}),s>0&&n>=7&&(0,r.jsx)("div",{className:"bg-green-50 p-4 rounded-lg border-l-4 border-green-400",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"✅"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Datenbasis vorhanden"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Wir haben genug Daten f\xfcr eine erste Analyse. Die Empfehlung wird mit mehr Daten pr\xe4ziser."})]})]})})]})}function A(e){var t,s,a;let{productId:i}=e,[l,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1),[x,g]=(0,n.useState)(!1),[p,b]=(0,n.useState)(null),{currentShop:f,isDemoMode:j}=(0,c.L)(),y=async()=>{if(!i)return;let e="string"==typeof i?parseInt(i,10):i;if(isNaN(e)){b("Ung\xfcltige Produkt-ID");return}h(!0),b(null);try{console.log("[LatestRecommendation] \uD83D\uDD04 Generating FRESH recommendation for product:",e);let t=await (0,d.n8)(e);console.log("[LatestRecommendation] ✅ Fresh recommendation generated:",t);let s=t.recommendation||t;if(s){console.log("[LatestRecommendation] Recommendation data:",s),s.product_name||(s.product_name=t.product_name||"Product ".concat(s.product_id)),!s.current_price&&t.current_price&&(s.current_price=t.current_price);let e=s.reasoning;if("string"==typeof s.reasoning)try{e=JSON.parse(s.reasoning)}catch(t){e=s.reasoning}s.reasoning=e,console.log("[LatestRecommendation] ✅ Setting fresh recommendation:",s),m(s)}else console.log("[LatestRecommendation] No recommendation in response"),m(null)}catch(e){console.error("[LatestRecommendation] Error generating recommendation:",e),console.error("[LatestRecommendation] Error details:",e.response||e.message),b(e.message||"Fehler beim Generieren der Empfehlung"),m(null)}finally{h(!1)}},v=async()=>{if(!i){alert("Bitte w\xe4hle eine Produkt-ID aus!");return}if(isNaN("string"==typeof i?parseInt(i,10):i)){alert("Ung\xfcltige Produkt-ID");return}g(!0),b(null);try{console.log("[LatestRecommendation] \uD83D\uDD04 Manual refresh requested"),await y()}catch(e){console.error("[LatestRecommendation] Error generating recommendation:",e),b(e.message||"Fehler beim Generieren der Empfehlung")}finally{g(!1)}},N=async e=>{if(!i){alert("Bitte w\xe4hle eine Produkt-ID aus!");return}if(j){alert("Demo Mode: Preis kann nicht auf Shopify angewendet werden.");return}if(!(null==f?void 0:f.id)){alert("Kein Shop ausgew\xe4hlt. Bitte w\xe4hle einen Shop aus.");return}let t="string"==typeof i?parseInt(i,10):i;if(isNaN(t)){alert("Ung\xfcltige Produkt-ID");return}try{console.log("[LatestRecommendation] Applying price:",{productIdNum:t,price:e,shopId:f.id});let s=await o({product_id:t,recommended_price:e});console.log("[LatestRecommendation] Price applied successfully:",s),alert("Preis erfolgreich auf Shopify aktualisiert: €".concat(s.new_price.toFixed(2))),await y()}catch(e){throw console.error("[LatestRecommendation] Error applying price:",e),alert("Fehler beim Anwenden des Preises: ".concat(e.message||"Unbekannter Fehler")),e}};if((0,n.useEffect)(()=>{y()},[i]),u||x)return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsxs)("div",{className:"text-gray-600 text-center",children:[(0,r.jsx)("p",{className:"font-medium",children:"Analysiere aktuelle Marktdaten..."}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Pr\xfcfe Wettbewerber, analysiere 90 Tage Verkaufsdaten..."})]})]});if(p)return(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-red-700 text-sm",children:p}),(0,r.jsx)("button",{onClick:y,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Erneut versuchen"})]});if(!l)return(0,r.jsx)(M,{productId:i,competitorCount:0,salesDataDays:0,onRunAnalysis:v});let w=!l.confidence||l.confidence===-1/0||l.confidence<0||isNaN(l.confidence),_=l.competitor_avg_price?1:0,k=l.sales_7d?7:0;if(w||0===_&&k<7)return(0,r.jsx)(M,{productId:i,competitorCount:_,salesDataDays:k,onRunAnalysis:v});let D=l.reasoning,C="object"==typeof D&&null!==D?D:{},P=C.strategies||{},A=[];A=l.strategy_details&&Array.isArray(l.strategy_details)?l.strategy_details:l.strategyDetails&&Array.isArray(l.strategyDetails)?l.strategyDetails:Object.entries(P).map(e=>{var t;let[s,r]=e;return{strategy:s,recommended_price:(null==r?void 0:r.price)||(null==r?void 0:r.recommended_price)||l.recommended_price,confidence:(null==r?void 0:r.confidence)||.5,reasoning:(null==r?void 0:r.reasoning)||"",competitor_context:(null==r?void 0:r.competitor_context)||(null==r?void 0:null===(t=r.competitive)||void 0===t?void 0:t.competitor_context)}});let F=(null===(t=P.competitive)||void 0===t?void 0:t.competitor_context)||(null===(s=P.competitive)||void 0===s?void 0:s.competitor_context),E=l.competitor_avg_price?{avg:l.competitor_avg_price,min:(null==F?void 0:F.min_price)||.9*l.competitor_avg_price,max:(null==F?void 0:F.max_price)||1.1*l.competitor_avg_price,prices:(null==F?void 0:null===(a=F.sources)||void 0===a?void 0:a.map((e,t)=>({source:e,price:l.competitor_avg_price*(.9+.05*t)})))||[]}:void 0,z={product_id:l.product_id,product_name:l.product_name,current_price:l.current_price,recommended_price:l.recommended_price,price_change:l.recommended_price-l.current_price,price_change_pct:l.price_change_pct,confidence:l.confidence,reasoning:"string"==typeof D?D:C.summary||JSON.stringify(C),strategy_details:A.length>0?A:void 0,competitor_data:E,created_at:l.created_at,generated_at:l.created_at};return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(S,{recommendation:z,onRefresh:v,onDismiss:()=>{},onApply:N})})}function F(e){let{competitors:t,yourPrice:s}=e,[a,i]=(0,n.useState)("all");if(!t||0===t.length)return(0,r.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,r.jsx)("p",{className:"font-medium mb-2",children:"❓ Unbekannt"}),(0,r.jsx)("p",{className:"text-sm",children:"Keine Wettbewerber gefunden"}),(0,r.jsx)("p",{className:"text-xs mt-2 text-gray-400",children:"Die Suche hat keine Ergebnisse zur\xfcckgegeben. M\xf6gliche Gr\xfcnde:"}),(0,r.jsxs)("ul",{className:"text-xs mt-2 text-gray-400 text-left max-w-md mx-auto",children:[(0,r.jsx)("li",{children:"• Produktname zu spezifisch oder ungew\xf6hnlich"}),(0,r.jsx)("li",{children:"• Serper API Key fehlt oder ist ung\xfcltig"}),(0,r.jsx)("li",{children:"• Rate Limit erreicht (2500 Calls/Monat)"}),(0,r.jsx)("li",{children:"• Keine Shopping-Ergebnisse f\xfcr dieses Produkt verf\xfcgbar"})]})]});let l=e=>{let t=(e.title||"").toLowerCase(),s=(e.source||"").toLowerCase();return t.includes("gebraucht")||t.includes("used")||t.includes("wie neu")||t.includes("zustand")||s.includes("kleinanzeigen")||s.includes("willhaben")||s.includes("shpock")||s.includes("vinted")?"used":t.includes("refurbished")||t.includes("general\xfcberholt")?"refurbished":"new"},c=[...t.filter(e=>"all"===a||l(e)===a)].sort((e,t)=>e.price-t.price),d=t.filter(e=>"new"===l(e)).length,o=t.filter(e=>"used"===l(e)).length,m=t.filter(e=>"refurbished"===l(e)).length,u=c.every(e=>e.price<s),h=c.length>0?Math.max(...c.map(e=>e.price)):0,x=(e,t)=>0===e?{label:"G\xdcNSTIGSTER",icon:"\uD83D\uDFE2"}:e===t-1?{label:"TEUERSTER",icon:"\uD83D\uDD34"}:{label:"#".concat(e+1),icon:"\uD83D\uDFE1"};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDCB0"}),t.length," WETTBEWERBER IM VERGLEICH"]}),(0,r.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("all"===a?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>i("all"),children:"Alle"}),d>0&&(0,r.jsxs)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("new"===a?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>i("new"),children:["Nur Neuware (",d,")"]}),o>0&&(0,r.jsxs)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("used"===a?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>i("used"),children:["Nur Gebraucht (",o,")"]}),m>0&&(0,r.jsxs)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("refurbished"===a?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>i("refurbished"),children:["Nur Refurbished (",m,")"]})]}),(0,r.jsx)("div",{className:"space-y-4",children:c.map((e,t)=>{let{label:n,icon:a}=x(t,c.length),i=l(e),d=s-e.price,o=Math.round(d/s*100);return(0,r.jsxs)("div",{className:"border-2 rounded-lg p-5 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:a}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:n}),(0,r.jsx)("div",{className:"text-xl font-bold",children:e.source})]})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:k(e.price)})})]}),(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsx)("p",{className:"text-sm text-gray-700 line-clamp-2",children:e.title})}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm mb-4",children:[e.rating&&(0,r.jsxs)("span",{className:"text-gray-600",children:["⭐ ",e.rating.toFixed(1)," Sterne"]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full font-medium ".concat("new"===i?"bg-green-100 text-green-800":"refurbished"===i?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"new"===i?"Neuware":"refurbished"===i?"Refurbished":"Gebraucht"})]}),(0,r.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-3 rounded",children:(0,r.jsxs)("p",{className:"text-sm font-medium text-blue-900",children:["\uD83D\uDCA1 ",k(Math.abs(d))," g\xfcnstiger als du (",o>0?"-":"+",Math.abs(o),"%)"]})})]},t)})}),u&&c.length>0&&(0,r.jsx)("div",{className:"mt-6 bg-orange-50 border-l-4 border-orange-400 p-4",children:(0,r.jsxs)("p",{className:"text-sm font-medium text-orange-900",children:["⚠️ ",(0,r.jsx)("strong",{children:"WICHTIG:"})," Selbst der teuerste Wettbewerber ist"," ",k(s-h)," g\xfcnstiger als dein aktueller Preis!"]})})]})}let E=["kleinanzeigen","ebay kleinanzeigen","willhaben","facebook marketplace","shpock","vinted","ebay"],z=["bundle","set","kit","paket","creator edition","limited edition","special edition","travel bundle","starter kit","combo","pack","+","mit","inkl.","inklusive","includes","enth\xe4lt","zubeh\xf6r","accessories"];function B(e){let t=e.toLowerCase();for(let e of z)if(t.includes(e)){if("edition"===e&&t.includes("standard edition"))continue;return!0}return!!(/\+\s*[A-Za-z]/.test(e)||/mit\s+[A-Za-z]/.test(t))}function I(e){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}let K=e=>"competitor_analysis_".concat(e),L=e=>{try{let t=localStorage.getItem(K(e));if(t){let s=JSON.parse(t);if(Date.now()-(s.cached_at||0)<864e5)return s.data;localStorage.removeItem(K(e))}}catch(e){console.error("Fehler beim Laden aus Cache:",e)}return null},T=(e,t)=>{try{localStorage.setItem(K(e),JSON.stringify({data:t,cached_at:Date.now()}))}catch(e){console.error("Fehler beim Speichern im Cache:",e)}};function R(e){let{productId:t,currentPrice:s}=e,[a,i]=(0,n.useState)(!1),[l,c]=(0,n.useState)(null),[o,m]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=L(t);e&&c(e)},[t]);let u=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i(!0),m(null);try{let s=await (0,d.Ow)(t,{maxResults:5,forceRefresh:e});c(s),T(t,s)}catch(t){var s,r,n;console.error("[CompetitorAnalysis] Fehler beim Laden:",t);let e="Fehler beim Laden der Wettbewerber-Daten";(null==t?void 0:null===(s=t.response)||void 0===s?void 0:s.status)===404?e="Produkt nicht gefunden. Pr\xfcfe Shop-Auswahl und Produkt-ID.":(null==t?void 0:null===(r=t.response)||void 0===r?void 0:r.status)===429?e="API-Limit erreicht. Bitte sp\xe4ter erneut versuchen.":(null==t?void 0:null===(n=t.response)||void 0===n?void 0:n.status)===500?e="Server-Fehler. Bitte sp\xe4ter erneut versuchen oder Support kontaktieren.":(null==t?void 0:t.message)&&(e=t.message),m(e)}finally{i(!1)}},h=(()=>{if(!l||!l.competitors||0===l.competitors.length)return null;let e=l.competitors.map(e=>e.price),t=Math.min(...e),r=Math.max(...e),n=e.reduce((e,t)=>e+t,0)/e.length,a=s-n,i=n>0?(s-n)/n*100:0,c=l.competitors.filter(e=>{let t=(e.title||"").toLowerCase(),s=(e.source||"").toLowerCase();return!(t.includes("gebraucht")||t.includes("used")||s.includes("kleinanzeigen")||s.includes("willhaben"))&&!(t.includes("refurbished")||t.includes("general\xfcberholt"))}),d=l.competitors.filter(e=>{let t=(e.title||"").toLowerCase(),s=(e.source||"").toLowerCase();return t.includes("gebraucht")||t.includes("used")||s.includes("kleinanzeigen")||s.includes("willhaben")}),o=c.length>0?Math.min(...c.map(e=>e.price)):null,m=c.length>0?Math.max(...c.map(e=>e.price)):null,u=d.length>0?Math.min(...d.map(e=>e.price)):null;return{minPrice:t,maxPrice:r,avgPrice:n,priceSpread:r-t,yourPriceDiff:a,percentAboveAvg:i,competitorCount:l.competitors.length,newCount:c.length,usedCount:d.length,newMin:o,newMax:m,usedMin:u}})(),x=l?function(e){var t;let s=e.offers.filter(e=>!("new"!==e.condition||function(e){let t=e.toLowerCase();for(let e of E)if(t.includes(e))return!0;return!1}(e.source)||B(e.title))),r=function(e){if(0===e.length)return{core_count:0,core_min:0,core_max:0,core_avg:0,price_spread_pct:0};let t=e.map(e=>e.price).sort((e,t)=>e-t),s=Math.round(100*t[0])/100,r=Math.round(100*t[t.length-1])/100,n=Math.round(t.reduce((e,t)=>e+t,0)/t.length*100)/100;return{core_count:e.length,core_min:s,core_max:r,core_avg:n,price_spread_pct:Math.round(100*(n>0?(r-s)/n*100:0))/100}}(s),n=function(e,t){if(0===t)return"unbekannt";let s=(e-t)/t*100;return s<-15?"deutlich unter Durchschnitt":s<-5?"unter Durchschnitt":s<=5?"im Bereich des Durchschnitts":s<=20?"\xfcber Durchschnitt":"deutlich \xfcber Durchschnitt"}(e.our_price,r.core_avg),a=e.data_age_days||0,i=function(e,t,s){let r=[],n=!1;return e<3&&(n=!0,r.push("zu wenig vergleichbare Angebote")),t>7&&(n=!0,r.push("Daten sind ".concat(t," Tage alt"))),s>40&&(n=!0,r.push("sehr hohe Preisstreuung")),{isUncertain:n,reasons:r}}(r.core_count,a,r.price_spread_pct),l=e.offers.filter(e=>"used"===e.condition),c=e.offers.filter(e=>"new"===e.condition&&B(e.title)),d=l.length>0?Math.round(100*Math.min(...l.map(e=>e.price)))/100:null,o=c.length>0?Math.round(100*Math.min(...c.map(e=>e.price)))/100:null,m=function(e,t,s){if(0===s)return"Keine vergleichbaren Neuware-Angebote gefunden.";if(1===s){let s=e-t.core_avg,r=s>0?"".concat(I(Math.abs(s))," teurer"):"".concat(I(Math.abs(s))," g\xfcnstiger");return"Du liegst mit ".concat(I(e)," ").concat(r," als das einzige vergleichbare Neuware-Angebot (").concat(I(t.core_avg),").")}let r=t.core_avg>0?(e-t.core_avg)/t.core_avg*100:0;if(1>Math.abs(r))return"Du liegst mit ".concat(I(e)," nahe am Marktdurchschnitt von ").concat(I(t.core_avg),".");let n=Math.abs(r).toFixed(1);return"Du liegst mit ".concat(I(e)," ").concat(n,"% ").concat(r>0?"\xfcber":"unter"," dem Marktdurchschnitt von ").concat(I(t.core_avg),".")}(e.our_price,r,s.length);return{summary:m,marketOverview:function(e,t,s,r){let n=[];return 0===r?n.push("Keine vergleichbaren Neuware-Angebote gefunden."):1===r?n.push("Nur 1 vergleichbares Neuware-Angebot gefunden (".concat(I(e.core_avg),").")):(n.push("".concat(r," vergleichbare Neuware-Angebote gefunden (Spanne: ").concat(I(e.core_min)," – ").concat(I(e.core_max),").")),n.push("Durchschnittspreis: ".concat(I(e.core_avg),"."))),null!==s&&n.push("Bundles mit Zubeh\xf6r starten ab ".concat(I(s)," (nicht in der Berechnung).")),null!==t&&n.push("Gebrauchtangebote starten ab ".concat(I(t)," (nicht in der Berechnung).")),n}(r,d,o,s.length),position:(t=e.our_price,0===r.core_count?"Vergleichsbasis fehlt – Position kann nicht bestimmt werden.":r.core_count<3?"Vergleichsbasis ist sehr d\xfcnn – Position kann nicht sicher bestimmt werden.":"im Bereich des Durchschnitts"===n?"Du liegst im Bereich des Marktdurchschnitts – wettbewerbsf\xe4hige Position.":"Deine Position: ".concat(n," (").concat(I(t)," vs. Durchschnitt ").concat(I(r.core_avg),").")),dataQuality:function(e,t,s){if(!e.isUncertain){let e=0===t?"aktuell":1===t?"vor 1 Tag":"vor ".concat(t," Tagen");return"Wettbewerbsdaten sind zuverl\xe4ssig (".concat(s," vergleichbare Angebote, Stand: ").concat(e,").")}let r=e.reasons.join(", "),n=0===t?"aktuell":1===t?"vor 1 Tag":"vor ".concat(t," Tagen");return"Hinweis: Wettbewerbsdaten sind eingeschr\xe4nkt zuverl\xe4ssig (".concat(r,", Stand: ").concat(n,").")}(i,a,r.core_count)}}({product_title:l.product_title||"",our_price:s,offers:l.competitors.map(e=>{let t="new",s=(e.title||"").toLowerCase(),r=(e.source||"").toLowerCase();return s.includes("gebraucht")||s.includes("used")||r.includes("kleinanzeigen")||r.includes("willhaben")?t="used":(s.includes("refurbished")||s.includes("general\xfcberholt"))&&(t="refurbished"),{source:e.source||"Unknown",title:e.title||"",price:e.price,rating:e.rating,url:e.url||"",condition:t}}),data_age_days:0}):null,g=(()=>{if(!h)return{label:"Unbekannt",color:"gray",explanation:""};let e=h.priceSpread/h.avgPrice>.4,t=h.competitorCount<3;return e||t?{label:"Eingeschr\xe4nkt zuverl\xe4ssig",color:"orange",explanation:e?"sehr hohe Preisstreuung":"zu wenig vergleichbare Angebote"}:{label:"Zuverl\xe4ssig",color:"green",explanation:""}})();return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83C\uDFE2"}),"Wettbewerbsanalyse"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[l&&(0,r.jsx)("button",{onClick:()=>u(!0),disabled:a,className:"text-sm text-gray-600 hover:text-gray-900 px-3 py-1 rounded hover:bg-gray-100 disabled:opacity-50",children:"\uD83D\uDD04 Aktualisieren"}),(0,r.jsx)("button",{onClick:()=>u(!1),disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 transition",children:a?"Suche l\xe4uft...":l?"Erneut suchen":"Wettbewerber suchen"})]})]}),l&&x&&x.dataQuality.includes("eingeschr\xe4nkt")&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-orange-50 border-l-4 border-orange-400 rounded",children:(0,r.jsxs)("p",{className:"text-sm font-medium text-orange-900",children:["⚠️ Hinweis: ",x.dataQuality]})})]}),a&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Suche Wettbewerber-Preise..."})]}),o&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-1",children:"⚠️ Fehler"}),(0,r.jsx)("p",{className:"text-sm",children:o})]}),l&&!a&&h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDCCA"}),"DEINE MARKTPOSITION AUF EINEN BLICK"]}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-green-50 via-yellow-50 to-red-50 rounded-lg p-6 mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-600 mb-1",children:"\uD83D\uDCB6 G\xfcnstigster"}),(0,r.jsx)("div",{className:"text-xl font-bold text-green-700",children:k(h.minPrice)})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-gray-600 mb-1",children:"\uD83D\uDCB6 \xd8-Preis"}),(0,r.jsx)("div",{className:"text-xl font-bold text-gray-800",children:k(h.avgPrice)})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-gray-600 mb-1",children:"\uD83D\uDCB6 Teuerster"}),(0,r.jsx)("div",{className:"text-xl font-bold text-orange-700",children:k(h.maxPrice)})]})]}),(0,r.jsxs)("div",{className:"relative mt-6",children:[(0,r.jsx)("div",{className:"h-3 bg-gradient-to-r from-green-400 via-yellow-400 to-red-400 rounded-full"}),(0,r.jsxs)("div",{className:"absolute -top-1 w-5 h-5 bg-red-600 rounded-full border-3 border-white shadow-lg z-10",style:{left:"".concat(Math.min(95,Math.max(5,(s-h.minPrice)/(h.maxPrice-h.minPrice)*100)),"%"),transform:"translateX(-50%)"},children:[(0,r.jsx)("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 whitespace-nowrap",children:(0,r.jsx)("div",{className:"bg-red-600 text-white px-2 py-1 rounded text-xs font-bold",children:"DU"})}),(0,r.jsx)("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 whitespace-nowrap",children:(0,r.jsx)("div",{className:"font-bold text-sm",children:k(s)})})]})]}),(0,r.jsx)("div",{className:"text-center mt-8",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-4 py-2 rounded-full text-sm font-bold bg-red-100 text-red-800",children:["⚠️ Du bist ",h.percentAboveAvg.toFixed(1),"% teurer als der Durchschnitt"]})})]}),h.percentAboveAvg>50&&(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDEA8"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-bold text-red-900 mb-1",children:"RISIKO: Du bist teurer als ALLE gefundenen Wettbewerber!"}),(0,r.jsx)("p",{className:"text-sm text-red-800",children:"Kunden werden wahrscheinlich zur Konkurrenz wechseln."})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDCC8"}),"MARKTDATEN IM \xdcBERBLICK"]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-blue-700",children:h.competitorCount}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Gefunden",(0,r.jsx)("br",{}),"Anbieter"]})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-green-700",children:k(h.avgPrice)}),(0,r.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"\xd8-Preis"})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-purple-700",children:k(h.priceSpread)}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Preis-",(0,r.jsx)("br",{}),"Spanne"]})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-red-700",children:["+",k(h.yourPriceDiff)]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Du vs \xd8",(0,r.jsx)("br",{}),"teurer"]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsxs)("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDCE6"}),"Produktzustand:"]}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm",children:[h.newCount>0&&(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-green-600",children:"• "}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Neuware:"})," ",h.newCount," Anbieter bieten von"," ",h.newMin&&k(h.newMin)," - ",h.newMax&&k(h.newMax)]})]}),h.usedCount>0&&(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"• "}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Gebraucht:"})," ",h.usedCount," Anbieter bieten ab"," ",h.usedMin&&k(h.usedMin)]})]})]})]})]}),(0,r.jsx)(F,{competitors:l.competitors,yourPrice:s}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"⚙️"}),"DATENQUALIT\xc4T & AKTUALIT\xc4T"]}),(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsxs)("div",{className:"px-4 py-2 rounded-lg font-medium ".concat("green"===g.color?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"),children:["Eingeschr\xe4nkt zuverl\xe4ssig"===g.label?"⚠️ ":"✅ ",g.label]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-700 mb-4",children:["Diese Daten sind ",(0,r.jsx)("strong",{children:"heute"})," aktualisiert worden, zeigen aber"," ",g.explanation||"eine normale Preisstreuung","."]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-2 text-sm",children:"Das bedeutet:"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm text-gray-700",children:[(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{children:"- "}),(0,r.jsx)("span",{children:"Die Produkte k\xf6nnten unterschiedliche Varianten sein"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{children:"- "}),(0,r.jsx)("span",{children:"Einige Angebote k\xf6nnten nicht mehr verf\xfcgbar sein"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{children:"- "}),(0,r.jsx)("span",{children:"Preise k\xf6nnen sich schnell \xe4ndern"})]})]})]}),(0,r.jsxs)("p",{className:"text-sm text-blue-700 mt-4",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Tipp:"}),' Nutze "Aktualisieren" um die neuesten Preise zu laden. Die Daten werden automatisch alle 24h erneuert.']})]})]})]})]}),!l&&!a&&!o&&(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("p",{children:"Noch keine Wettbewerber-Daten geladen."}),(0,r.jsx)("p",{className:"text-sm mt-2",children:'Klicke auf "Wettbewerber suchen" um zu starten.'})]})]})}let W=(0,m.Z)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),G=(0,m.Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),V=(0,m.Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);function U(e){var t,s,n,a,i;let{marginData:l,compact:c=!1,onAddCosts:d,onEditCosts:o}=e;if(!l.has_cost_data)return(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-lg",children:"\uD83D\uDCA1"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Noch pr\xe4ziser mit Kostendaten"}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 mb-3",children:["Die Preisempfehlung funktioniert auch ohne Kosten.",(0,r.jsx)("strong",{children:" Mit Kostendaten"})," k\xf6nnen wir zus\xe4tzlich deine ",(0,r.jsx)("strong",{children:"Marge optimieren"})," und sicherstellen, dass du immer profitabel bleibst."]}),d&&(0,r.jsx)("button",{onClick:d,className:"text-xs font-medium text-blue-600 hover:text-blue-700 underline transition",children:"Kosten hinterlegen (optional)"})]})]})});let m=l.is_above_min_margin?"text-green-600":l.is_above_break_even?"text-orange-600":"text-red-600",h=l.is_above_min_margin?"bg-green-50 border-green-200":l.is_above_break_even?"bg-orange-50 border-orange-200":"bg-red-50 border-red-200",x=l.is_above_min_margin?(0,r.jsx)(f.Z,{className:"w-5 h-5 text-green-600"}):l.is_above_break_even?(0,r.jsx)(u,{className:"w-5 h-5 text-orange-600"}):(0,r.jsx)(W,{className:"w-5 h-5 text-red-600"});return c?(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border-2 ".concat(h),children:[x,(0,r.jsxs)("span",{className:"font-semibold ".concat(m),children:[null===(a=l.margin)||void 0===a?void 0:a.percent.toFixed(1),"% Marge"]}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["(€",null===(i=l.margin)||void 0===i?void 0:i.euro.toFixed(2),")"]})]}):(0,r.jsxs)("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(G,{className:"w-6 h-6 text-gray-700"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Margin-Analyse"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 ".concat(m),children:[x,(0,r.jsxs)("span",{className:"text-2xl font-bold",children:[null===(t=l.margin)||void 0===t?void 0:t.percent.toFixed(1),"%"]})]}),l.has_cost_data&&o&&(0,r.jsxs)("button",{onClick:o,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg transition-all",title:"Kosten bearbeiten","aria-label":"Kostendaten bearbeiten",children:[(0,r.jsx)(V,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Bearbeiten"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-3 border-y",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Verkaufspreis"}),(0,r.jsxs)("p",{className:"text-xl font-semibold text-gray-900",children:["€",null===(s=l.selling_price)||void 0===s?void 0:s.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Nettoerl\xf6s",l.vat_rate&&(0,r.jsxs)("span",{className:"ml-1 text-xs",children:["(nach ",(100*l.vat_rate).toFixed(0),"% MwSt)"]})]}),(0,r.jsxs)("p",{className:"text-xl font-semibold text-gray-900",children:["€",null===(n=l.net_revenue)||void 0===n?void 0:n.toFixed(2)]})]})]}),l.costs&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Variable Kosten:"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"• Einkauf:"}),(0,r.jsxs)("span",{className:"font-medium text-gray-900",children:["€",l.costs.purchase.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"• Versand:"}),(0,r.jsxs)("span",{className:"font-medium text-gray-900",children:["€",l.costs.shipping.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"• Verpackung:"}),(0,r.jsxs)("span",{className:"font-medium text-gray-900",children:["€",l.costs.packaging.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["• Payment Fee",l.payment_provider&&(0,r.jsxs)("span",{className:"ml-1 text-xs",children:["(",l.payment_provider,")"]}),":"]}),(0,r.jsxs)("span",{className:"font-medium text-gray-900",children:["€",l.costs.payment_fee.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm font-semibold pt-2 border-t",children:[(0,r.jsx)("span",{className:"text-gray-900",children:"Gesamt:"}),(0,r.jsxs)("span",{className:"text-gray-900",children:["€",l.costs.total_variable.toFixed(2)]})]})]})]}),l.margin&&(0,r.jsxs)("div",{className:"p-4 rounded-lg border-2 ".concat(h),children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[x,(0,r.jsx)("span",{className:"font-semibold text-gray-900",children:"Deckungsbeitrag I:"})]}),(0,r.jsxs)("div",{className:"flex items-baseline gap-3",children:[(0,r.jsxs)("span",{className:"text-3xl font-bold ".concat(m),children:["€",l.margin.euro.toFixed(2)]}),(0,r.jsxs)("span",{className:"text-xl font-semibold ".concat(m),children:["(",l.margin.percent.toFixed(1),"%)"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[l.break_even_price&&(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-1",children:"⚠️ Break-Even:"}),(0,r.jsxs)("p",{className:"font-semibold text-gray-900",children:["€",l.break_even_price.toFixed(2)]})]}),l.recommended_min_price&&(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-1",children:"✅ Min. empfohlen (20%):"}),(0,r.jsxs)("p",{className:"font-semibold text-green-600",children:["€",l.recommended_min_price.toFixed(2)]})]})]}),!l.is_above_break_even&&(0,r.jsxs)("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3 text-sm",children:[(0,r.jsx)("p",{className:"font-semibold text-red-900 mb-1",children:"❌ KRITISCH: Unter Break-Even"}),(0,r.jsx)("p",{className:"text-red-800",children:"Dieser Preis liegt unter deinen Kosten. Du machst Verlust bei jedem Verkauf!"})]}),l.is_above_break_even&&!l.is_above_min_margin&&(0,r.jsxs)("div",{className:"bg-orange-100 border border-orange-300 rounded-lg p-3 text-sm",children:[(0,r.jsx)("p",{className:"font-semibold text-orange-900 mb-1",children:"⚠️ NIEDRIGE MARGE"}),(0,r.jsx)("p",{className:"text-orange-800",children:"Marge liegt unter der empfohlenen Mindestmarge von 20%. Ber\xfccksichtige Fixkosten und unerwartete Ausgaben."})]}),l.is_above_min_margin&&(0,r.jsxs)("div",{className:"bg-green-100 border border-green-300 rounded-lg p-3 text-sm",children:[(0,r.jsx)("p",{className:"font-semibold text-green-900 mb-1",children:"✅ GESUNDE MARGE"}),(0,r.jsx)("p",{className:"text-green-800",children:"Marge \xfcber 20% - gute Profitabilit\xe4t! Genug Puffer f\xfcr Fixkosten und Gewinn."})]})]})}let Z=(0,m.Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),O=(0,m.Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var q=s(5790);function H(e){let{isOpen:t,onClose:s,productId:a,productTitle:i,currentPrice:l,shopId:c,onSave:o}=e,[m,u]=(0,n.useState)({purchase_cost:0,shipping_cost:0,packaging_cost:0,payment_provider:"stripe",country_code:"DE",category:void 0}),[h,x]=(0,n.useState)(!1),[g,p]=(0,n.useState)(!1),[b,f]=(0,n.useState)(!1),[j,y]=(0,n.useState)(null),[N,w]=(0,n.useState)(null),[k,D]=(0,n.useState)(!1),[C,P]=(0,n.useState)(null);(0,n.useEffect)(()=>{t&&a&&S()},[t,a]);let S=async()=>{try{x(!0),w(null);let e=await (0,d.Rd)(a);e?(P({purchase_cost:e.purchase_cost,shipping_cost:e.shipping_cost,packaging_cost:e.packaging_cost,payment_provider:e.payment_provider,country_code:e.country_code,category:e.category}),u({purchase_cost:e.purchase_cost,shipping_cost:e.shipping_cost,packaging_cost:e.packaging_cost,payment_provider:e.payment_provider,country_code:e.country_code,category:e.category}),D(!1)):(P(null),u({purchase_cost:0,shipping_cost:0,packaging_cost:0,payment_provider:"stripe",country_code:"DE",category:void 0}),D(!0),w(null))}catch(t){var e;console.error("Failed to load costs:",t),(null==t?void 0:null===(e=t.response)||void 0===e?void 0:e.status)!==404&&(null==t?void 0:t.status)!==404?w("Fehler beim Laden der Kosten"):(P(null),D(!0),w(null))}finally{x(!1)}};(0,n.useEffect)(()=>{m.category&&M(m.category)},[m.category]);let M=async e=>{try{let t=await (0,d.$m)(e);y(t)}catch(e){console.error("Failed to load category defaults:",e)}},A=async()=>{if(!l||!m.category){w("Bitte w\xe4hle zuerst eine Kategorie");return}x(!0),w(null);try{let e=await (0,d.R5)(l,m.category,m.country_code);u(t=>({...t,purchase_cost:e.estimated_purchase_cost,shipping_cost:e.estimated_shipping_cost,packaging_cost:e.estimated_packaging_cost})),f(!0)}catch(e){console.error("Failed to estimate costs:",e),w("Fehler beim Sch\xe4tzen der Kosten")}finally{x(!1)}},F=async()=>{if(m.purchase_cost<=0){w("Einkaufspreis muss gr\xf6\xdfer als 0 sein");return}p(!0),w(null);try{C?await (0,d._M)(a,m):await (0,d.QJ)(a,m),await o(m),await S(),D(!0)}catch(e){console.error("Failed to save costs:",e),w((null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Fehler beim Speichern der Kosten")}finally{p(!1)}};if(!t)return null;let E=m.purchase_cost+m.shipping_cost+m.packaging_cost,z=l?(l/1.19-E)/(l/1.19)*100:0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:s}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between p-6 border-b sticky top-0 bg-white z-10",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Kosten hinterlegen"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:i})]}),(0,r.jsx)("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition",children:(0,r.jsx)(_,{className:"w-6 h-6"})})]}),N&&(0,r.jsx)("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-800 text-sm",children:N}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[C&&!k&&(0,r.jsxs)("div",{className:"bg-green-50 border-2 border-green-300 rounded-xl p-6 mb-8 shadow-md",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-green-800 mb-1",children:"✅ Gespeicherte Kosten"}),(0,r.jsx)("p",{className:"text-sm text-green-700",children:"Klicke Bearbeiten um Werte anzupassen"})]}),(0,r.jsxs)("button",{onClick:()=>D(!0),className:"px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 flex items-center gap-2 shadow-md transition-all hover:scale-105",title:"Kosten bearbeiten",children:[(0,r.jsx)(V,{className:"w-4 h-4"}),"Bearbeiten"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Einkauf:"}),(0,r.jsxs)("span",{className:"font-bold ml-2 text-gray-900",children:["€",C.purchase_cost.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Versand:"}),(0,r.jsxs)("span",{className:"font-bold ml-2 text-gray-900",children:["€",C.shipping_cost.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Verpackung:"}),(0,r.jsxs)("span",{className:"font-bold ml-2 text-gray-900",children:["€",C.packaging_cost.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Payment:"}),(0,r.jsx)("span",{className:"font-bold ml-2 text-gray-900",children:C.payment_provider})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"MwSt:"}),(0,r.jsx)("span",{className:"font-bold ml-2 text-gray-900",children:C.country_code})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Kategorie:"}),(0,r.jsx)("span",{className:"font-bold ml-2 text-gray-900",children:C.category||"N/A"})]})]}),(0,r.jsx)("div",{className:"pt-4 border-t border-green-300",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"font-bold text-gray-900",children:"Gesamt Kosten:"}),(0,r.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:["€",(C.purchase_cost+C.shipping_cost+C.packaging_cost).toFixed(2)]})]})})]}),(k||!C)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kategorie"}),(0,r.jsxs)("select",{value:m.category||"",onChange:e=>u(t=>({...t,category:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Kategorie w\xe4hlen..."}),["fashion","electronics","beauty","home","food"].map(e=>(0,r.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),j&&(0,r.jsx)("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(Z,{className:"w-4 h-4 text-blue-600 mt-0.5"}),(0,r.jsxs)("div",{className:"text-sm text-blue-900",children:[(0,r.jsxs)("p",{className:"font-medium",children:["Typisch f\xfcr ",m.category,":"]}),(0,r.jsxs)("p",{children:["Versand: €",j.shipping_estimate.toFixed(2),", Verpackung: €",j.packaging_estimate.toFixed(2)]}),(0,r.jsx)("button",{onClick:()=>{j&&u(e=>({...e,shipping_cost:j.shipping_estimate,packaging_cost:j.packaging_estimate}))},className:"text-blue-600 hover:text-blue-800 font-medium mt-1 underline",children:"→ Werte \xfcbernehmen"})]})]})})]}),l&&m.category&&(0,r.jsxs)("button",{onClick:A,disabled:h,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[h?(0,r.jsx)(O,{className:"w-4 h-4 animate-spin"}):(0,r.jsx)(q.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:h?"Sch\xe4tze...":"Kosten sch\xe4tzen (Verkaufspreis: €".concat(l.toFixed(2),")")})]}),b&&(0,r.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-800",children:"⚠️ Dies sind Sch\xe4tzungen basierend auf Branchendurchschnitten. Bitte mit echten Daten ersetzen!"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCB0 Einkaufspreis (netto) *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",value:m.purchase_cost||"",onChange:e=>u(t=>({...t,purchase_cost:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00",required:!0}),(0,r.jsx)("span",{className:"absolute right-3 top-2.5 text-gray-500",children:"€"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCE6 Versandkosten (pro St\xfcck)"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",value:m.shipping_cost||"",onChange:e=>u(t=>({...t,shipping_cost:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),(0,r.jsx)("span",{className:"absolute right-3 top-2.5 text-gray-500",children:"€"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCE6 Verpackung (pro St\xfcck)"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",value:m.packaging_cost||"",onChange:e=>u(t=>({...t,packaging_cost:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),(0,r.jsx)("span",{className:"absolute right-3 top-2.5 text-gray-500",children:"€"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCB3 Payment Provider"}),(0,r.jsx)("select",{value:m.payment_provider,onChange:e=>u(t=>({...t,payment_provider:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[{value:"stripe",label:"Stripe (2.9% + €0.30)"},{value:"paypal",label:"PayPal (2.49% + €0.35)"},{value:"klarna",label:"Klarna (4.5%)"},{value:"custom",label:"Custom"}].map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83C\uDF0D Land (MwSt)"}),(0,r.jsxs)("select",{value:m.country_code,onChange:e=>u(t=>({...t,country_code:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"DE",children:"Deutschland (19%)"}),(0,r.jsx)("option",{value:"AT",children:"\xd6sterreich (20%)"}),(0,r.jsx)("option",{value:"CH",children:"Schweiz (7.7%)"}),(0,r.jsx)("option",{value:"GB",children:"UK (20%)"}),(0,r.jsx)("option",{value:"US",children:"USA (0%)"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Summe variable Kosten:"}),(0,r.jsxs)("span",{className:"font-semibold",children:["€",E.toFixed(2)]})]}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Aktueller Preis:"}),(0,r.jsxs)("span",{className:"font-semibold",children:["€",l.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[(0,r.jsx)("span",{children:"Gesch\xe4tzte Marge:"}),(0,r.jsxs)("span",{className:z>=20?"text-green-600":"text-orange-600",children:[z.toFixed(1),"%"]})]})]})]})]})]}),(0,r.jsx)("div",{className:"flex gap-3 p-6 border-t bg-gray-50 sticky bottom-0",children:C&&k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>{C&&u({...C}),D(!1),w(null)},disabled:g,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition disabled:opacity-50 flex items-center justify-center gap-2",children:[(0,r.jsx)(_,{className:"w-4 h-4"}),"Abbrechen"]}),(0,r.jsx)("button",{onClick:F,disabled:g||0===m.purchase_cost,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{className:"w-4 h-4 animate-spin"}),(0,r.jsx)("span",{children:"Speichern..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Speichern"})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:s,disabled:g,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition disabled:opacity-50",children:C?"Schlie\xdfen":"Abbrechen"}),!C&&(0,r.jsx)("button",{onClick:F,disabled:g||0===m.purchase_cost,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{className:"w-4 h-4 animate-spin"}),(0,r.jsx)("span",{children:"Speichern..."})]}):(0,r.jsx)("span",{children:"Kosten erfassen"})})]})})]})})]})}let J=(0,m.Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Q=(0,m.Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);function $(){var e;let t=(0,i.useSearchParams)().get("product_id"),[s,o]=(0,n.useState)(t?Number(t):1),[m,u]=(0,n.useState)(0),[h,x]=(0,n.useState)(null),[g,p]=(0,n.useState)(!1),[b,f]=(0,n.useState)(""),[j,y]=(0,n.useState)({margin:!1,price:!1,competitor:!1}),[v,N]=(0,n.useState)({margin:!1,price:!1,competitor:!1}),{isDemoMode:w,currentShop:_}=(0,c.L)(),k=e=>{y(t=>({...t,[e]:!t[e]}))};return(0,n.useEffect)(()=>{if(!s||!_){console.log("[RecommendationsPage] Missing productId or currentShop, skipping load");return}(async()=>{try{var e;console.log("[RecommendationsPage] Loading product data:",{productId:s,shopId:_.id,isDemoMode:w});let t=await (0,d.t2)();console.log("[RecommendationsPage] Products received:",t.length,"First ID type:",typeof(null===(e=t[0])||void 0===e?void 0:e.id)),console.log("[RecommendationsPage] Searching for:",s,"Type:",typeof s);let r=t.find(e=>String(e.id)===String(s));if(!r){console.error("[RecommendationsPage] Product not found in current shop",{productId:s,productIdType:typeof s,currentShop:_,productsCount:t.length,availableIds:t.slice(0,5).map(e=>({id:e.id,idType:typeof e.id}))}),x({has_cost_data:!1,error:"Produkt ".concat(s," nicht im aktuellen Shop gefunden. Bitte Shop wechseln oder Produkt-ID pr\xfcfen.")}),u(0),f("Product ".concat(s," (nicht gefunden)"));return}if(console.log("[RecommendationsPage] Product found:",{id:r.id,title:r.title,price:r.price}),u(r.price||0),f(r.title||r.name||"Product ".concat(s)),r.price&&r.price>0)try{let e=await (0,d.ku)(s.toString(),r.price);x(e)}catch(e){x({has_cost_data:!1})}}catch(e){console.error("[RecommendationsPage] Fehler beim Laden der Produktdaten:",e),x({has_cost_data:!1,error:"Fehler beim Laden der Produktdaten."})}})()},[s,null==_?void 0:_.id,w]),(0,n.useEffect)(()=>{let e=e=>{console.log("[RecommendationsPage] Shop switched event received:",e.detail),s&&setTimeout(()=>{(async()=>{try{let e=(await (0,d.t2)()).find(e=>String(e.id)===String(s));e?(console.log("[RecommendationsPage] Product reloaded after shop switch:",{id:e.id,title:e.title,price:e.price}),u(e.price||0),f(e.title||e.name||"Product ".concat(s))):x({has_cost_data:!1,error:"Produkt ".concat(s," nicht im neuen Shop gefunden.")})}catch(e){console.error("[RecommendationsPage] Error reloading product after shop switch:",e)}})()},300)};return window.addEventListener("shop-switched",e),()=>window.removeEventListener("shop-switched",e)},[s]),(0,n.useEffect)(()=>{let e=e=>{e.target.closest(".info-tooltip-button")||N({margin:!1,price:!1,competitor:!1})};if(v.margin||v.price||v.competitor)return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[v]),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,r.jsxs)("aside",{className:"w-80 bg-gradient-to-b from-white via-gray-50 to-white border-r border-gray-200 p-6 overflow-y-auto shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-8 pb-6 border-b border-gray-200",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg transform hover:scale-105 transition-transform",children:(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCA1"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"PriceIQ"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(l.D,{})}),(0,r.jsxs)("nav",{className:"space-y-2",children:[(0,r.jsx)(a.rU,{href:"/",className:"block px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Dashboard"}),(0,r.jsx)(a.rU,{href:"/products",className:"block px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Produkte"}),(0,r.jsx)(a.rU,{href:"/recommendations",className:"block px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors bg-gray-100",children:"Empfehlungen"})]})]}),(0,r.jsx)("main",{className:"flex-1 p-8 overflow-y-auto",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg",children:(0,r.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCCA"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-1",children:"Produkt-Analysen"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Vollst\xe4ndige Analyse f\xfcr optimale Preisentscheidungen"})]})]}),(0,r.jsx)(a.rU,{href:"/",className:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium shadow-sm hover:shadow-md",children:"← Zur\xfcck"})]})}),(0,r.jsx)("div",{className:"mb-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border-2 border-blue-200 shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center flex-shrink-0",children:(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCE6"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:b||"Produkt ".concat(s)}),m>0&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Aktueller Preis: ",(0,r.jsxs)("span",{className:"font-semibold text-gray-900",children:[m.toFixed(2)," €"]})]})]})]})}),m>0&&h&&(0,r.jsxs)("section",{className:"mb-6",children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)("button",{onClick:()=>k("margin"),className:"w-full flex items-center justify-between p-6 bg-white rounded-lg border-2 border-gray-200 hover:border-blue-400 hover:shadow-lg transition-all duration-200 text-left",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"text-4xl",children:"\uD83D\uDCB0"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Margen-Analyse"}),(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),N(e=>({...e,margin:!e.margin}))},className:"relative info-tooltip-button",children:[(0,r.jsx)(Z,{className:"w-5 h-5 text-gray-400 hover:text-blue-600 transition-colors"}),v.margin&&(0,r.jsxs)("div",{className:"absolute left-0 bottom-full mb-2 w-80 p-4 bg-gray-900 text-white text-sm rounded-lg shadow-xl z-50",children:[(0,r.jsx)("div",{className:"font-semibold mb-2",children:"Was passiert hier?"}),(0,r.jsx)("p",{className:"mb-2",children:"Die Margen-Analyse zeigt dir, ob dein aktueller Preis \xfcber deinen Kosten liegt und wie viel Gewinn du pro Verkauf machst."}),(0,r.jsxs)("p",{className:"mb-2",children:[(0,r.jsx)("strong",{children:"Wichtig:"})," Bevor du Preise \xe4nderst, solltest du immer pr\xfcfen, dass du nicht unter deine Kosten verkaufst!"]}),(0,r.jsx)("p",{children:"Hier kannst du auch Kosten f\xfcr dein Produkt hinterlegen (Einkaufspreis, Versand, Verpackung, etc.)."}),(0,r.jsx)("div",{className:"absolute bottom-0 left-4 transform translate-y-full",children:(0,r.jsx)("div",{className:"w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-gray-900"})})]})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Pr\xfcfe deine Kosten und Margen vor Preis\xe4nderungen"})]})]}),j.margin?(0,r.jsx)(J,{className:"w-6 h-6 text-gray-500"}):(0,r.jsx)(Q,{className:"w-6 h-6 text-gray-500"})]})}),j.margin&&(0,r.jsx)("div",{className:"mt-4 bg-white rounded-lg border border-gray-200 p-6 transition-all duration-300 ease-in-out",children:(0,r.jsx)(U,{marginData:h||{has_cost_data:!1},onAddCosts:()=>p(!0),onEditCosts:()=>p(!0)})})]}),(0,r.jsxs)("section",{className:"mb-6",children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)("button",{onClick:()=>k("price"),className:"w-full flex items-center justify-between p-6 bg-white rounded-lg border-2 border-gray-200 hover:border-blue-400 hover:shadow-lg transition-all duration-200 text-left",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"text-4xl",children:"\uD83D\uDCA1"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Preisempfehlung"}),(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),N(e=>({...e,price:!e.price}))},className:"relative info-tooltip-button",children:[(0,r.jsx)(Z,{className:"w-5 h-5 text-gray-400 hover:text-blue-600 transition-colors"}),v.price&&(0,r.jsxs)("div",{className:"absolute left-0 bottom-full mb-2 w-80 p-4 bg-gray-900 text-white text-sm rounded-lg shadow-xl z-50",children:[(0,r.jsx)("div",{className:"font-semibold mb-2",children:"Was passiert hier?"}),(0,r.jsx)("p",{className:"mb-2",children:"Unsere KI analysiert verschiedene Faktoren wie Nachfrage, Lagerbestand, Wettbewerbspreise und deine Kosten, um dir eine optimale Preisempfehlung zu geben."}),(0,r.jsx)("p",{className:"mb-2",children:(0,r.jsx)("strong",{children:"Die Empfehlung ber\xfccksichtigt:"})}),(0,r.jsxs)("ul",{className:"list-disc list-inside mb-2 space-y-1",children:[(0,r.jsx)("li",{children:"Verkaufsdaten der letzten 30 Tage"}),(0,r.jsx)("li",{children:"Aktuelle Preise deiner Konkurrenten"}),(0,r.jsx)("li",{children:"Deine Lagerbest\xe4nde"}),(0,r.jsx)("li",{children:"Deine Kosten und Margen"})]}),(0,r.jsx)("p",{children:"Du kannst die Empfehlung direkt anwenden oder erst die Details ansehen."}),(0,r.jsx)("div",{className:"absolute bottom-0 left-4 transform translate-y-full",children:(0,r.jsx)("div",{className:"w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-gray-900"})})]})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"KI-basierte Preisempfehlung basierend auf Marktdaten"})]})]}),j.price?(0,r.jsx)(J,{className:"w-6 h-6 text-gray-500"}):(0,r.jsx)(Q,{className:"w-6 h-6 text-gray-500"})]})}),j.price&&(0,r.jsx)("div",{className:"mt-4 bg-white rounded-lg border border-gray-200 p-6 transition-all duration-300 ease-in-out",children:(0,r.jsx)(A,{productId:s})})]}),m>0&&(0,r.jsxs)("section",{className:"mb-6",children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)("button",{onClick:()=>k("competitor"),className:"w-full flex items-center justify-between p-6 bg-white rounded-lg border-2 border-gray-200 hover:border-blue-400 hover:shadow-lg transition-all duration-200 text-left",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"text-4xl",children:"\uD83C\uDFEA"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Wettbewerbsanalyse"}),(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),N(e=>({...e,competitor:!e.competitor}))},className:"relative info-tooltip-button",children:[(0,r.jsx)(Z,{className:"w-5 h-5 text-gray-400 hover:text-blue-600 transition-colors"}),v.competitor&&(0,r.jsxs)("div",{className:"absolute left-0 bottom-full mb-2 w-80 p-4 bg-gray-900 text-white text-sm rounded-lg shadow-xl z-50",children:[(0,r.jsx)("div",{className:"font-semibold mb-2",children:"Was passiert hier?"}),(0,r.jsx)("p",{className:"mb-2",children:"Die Wettbewerbsanalyse zeigt dir, wie dein Preis im Vergleich zu anderen Anbietern steht."}),(0,r.jsx)("p",{className:"mb-2",children:(0,r.jsx)("strong",{children:"Du siehst:"})}),(0,r.jsxs)("ul",{className:"list-disc list-inside mb-2 space-y-1",children:[(0,r.jsx)("li",{children:"Preise deiner Konkurrenten (Neuware, Gebraucht, etc.)"}),(0,r.jsx)("li",{children:"Deine Marktposition (g\xfcnstigster, teuerster, Durchschnitt)"}),(0,r.jsx)("li",{children:"Durchschnittspreis und Preisspanne"}),(0,r.jsx)("li",{children:"Datenqualit\xe4t der Analyse"})]}),(0,r.jsx)("p",{children:"Nutze diese Informationen, um deine Preise strategisch anzupassen."}),(0,r.jsx)("div",{className:"absolute bottom-0 left-4 transform translate-y-full",children:(0,r.jsx)("div",{className:"w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-gray-900"})})]})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Vergleiche deine Preise mit der Konkurrenz"})]})]}),j.competitor?(0,r.jsx)(J,{className:"w-6 h-6 text-gray-500"}):(0,r.jsx)(Q,{className:"w-6 h-6 text-gray-500"})]})}),j.competitor&&(0,r.jsx)("div",{className:"mt-4 bg-white rounded-lg border border-gray-200 p-6 transition-all duration-300 ease-in-out",children:(0,r.jsx)(R,{productId:s,currentPrice:m})})]})]})}),(0,r.jsx)(H,{isOpen:g,onClose:()=>p(!1),productId:s.toString(),productTitle:b||"Product ".concat(s),currentPrice:m,shopId:(null==_?void 0:null===(e=_.id)||void 0===e?void 0:e.toString())||"demo",onSave:async e=>{try{if(await (0,d.QJ)(s.toString(),e),p(!1),m>0){let e=await (0,d.ku)(s.toString(),m);x(e)}}catch(e){throw console.error("Fehler beim Speichern der Kosten:",e),e}}})]})}function X(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen p-8",children:"Lade..."}),children:(0,r.jsx)($,{})})}}},function(e){e.O(0,[146,75,971,938,744],function(){return e(e.s=1702)}),_N_E=e.O()}]);