(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[136],{3067:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(5531).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3523:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(5531).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},4530:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(5531).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1016:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(5531).Z)("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]])},4280:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(5531).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},5790:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(5531).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},1702:function(e,s,t){Promise.resolve().then(t.bind(t,1112))},1112:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ec}});var r=t(7437),a=t(2265),i=t(5967),n=t(4033),l=t(5996),c=t(7307),o=t(1424),d=t(826);async function h(e){let s=await fetch("".concat(d.T5,"/api/shopify/apply-price"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).detail||"Fehler beim Anwenden des Preises");return s.json()}var m=t(5531);let u=(0,m.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var x=t(8759);let p=(0,m.Z)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),g=(0,m.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),b=(0,m.Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var f=t(4280),j=t(8292);function v(e,s){return(...e)=>{try{return s(...e)}catch{throw Error(void 0)}}}let N=v(0,j.T_);v(0,j.Gb);var y=t(4530);let w=(0,m.Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),k=(0,m.Z)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var _=t(2442);function D(e){let{confidence:s,reasoning:t,compact:a=!1,confidenceBasis:i}=e,n=N("confidence"),l=s>1?s:100*s,c={high:{icon:y.Z,color:"green",bgColor:"bg-gradient-to-r from-green-50 to-emerald-50",borderColor:"border-green-200",textColor:"text-green-700",barColor:"bg-green-500",gradientBar:"bg-gradient-to-r from-green-500 to-emerald-600"},medium:{icon:w,color:"yellow",bgColor:"bg-gradient-to-r from-yellow-50 to-amber-50",borderColor:"border-yellow-200",textColor:"text-yellow-700",barColor:"bg-yellow-500",gradientBar:"bg-gradient-to-r from-yellow-500 to-amber-600"},low:{icon:k,color:"red",bgColor:"bg-gradient-to-r from-red-50 to-orange-50",borderColor:"border-red-200",textColor:"text-red-700",barColor:"bg-red-500",gradientBar:"bg-gradient-to-r from-red-500 to-orange-600"}}[l>=85?"high":l>=60?"medium":"low"],o=c.icon;if(a)return(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full border ".concat(c.bgColor," ").concat(c.borderColor),children:[(0,r.jsx)(o,{className:"w-4 h-4 ".concat(c.textColor)}),(0,r.jsxs)("span",{className:"text-sm font-semibold ".concat(c.textColor),children:[l.toFixed(0),"%"]})]});let d=(null==i?void 0:i.competitor_count)||0;return null==i||i.sales_30d,(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-2xl border-l-4 border-blue-500 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-blue-500 rounded-2xl flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(_.Z,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:n("title",{confidence:l.toFixed(0)})}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(l,"%")}})})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-white/50 rounded-xl border",children:[(0,r.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:["\uD83D\uDCCA ",(0,r.jsx)("span",{children:n("whatAnalyzes")})]}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-gray-700",children:[(0,r.jsx)("li",{children:"• Echte Verkaufsdaten aus deinem Shopify-Shop"}),(0,r.jsxs)("li",{children:["• Aktuelle Preise deiner ",d>0?"".concat(d,"-").concat(Math.max(d,10)):"5-10"," wichtigsten Konkurrenten"]}),(0,r.jsxs)("li",{children:["• ",(null==i?void 0:i.ml_models)||4," spezialisierte Machine-Learning-Modelle (Umsatz, Konkurrenz, Marge, Saisonalit\xe4t)"]}),(0,r.jsx)("li",{children:"• Deine eingetragenen Kosten und bisherigen Margen"})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-yellow-50/80 border border-yellow-200 rounded-xl",children:[(0,r.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:["\uD83D\uDCA1 ",n("why",{confidence:l.toFixed(0)})]}),(0,r.jsx)("p",{className:"text-sm text-gray-800 leading-relaxed",children:n("whyText")})]})]})}let C=(0,m.Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function P(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EUR";return new Intl.NumberFormat("de-DE",{style:"currency",currency:s,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function S(e){var s,t;let{recommendedPrice:i,onApply:n,onDismiss:l,isApplying:c,isDisabled:o=!1,marginAnalysis:d}=e,h=N("pricing"),m=N("common"),x=N("actions"),[p,f]=(0,a.useState)(!1),j=d&&!d.is_safe,v=(null==d?void 0:null===(t=d.details)||void 0===t?void 0:null===(s=t.margin)||void 0===s?void 0:s.euro)?30*d.details.margin.euro:null;return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,r.jsx)("button",{onClick:n,disabled:c||o,className:"\n            flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-semibold\n            transition-all duration-200 transform hover:scale-105\n            disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\n            ".concat(o?"bg-gray-300 text-gray-600":j?"bg-orange-600 hover:bg-orange-700 text-white shadow-lg hover:shadow-xl":"bg-green-600 hover:bg-green-700 text-white shadow-lg hover:shadow-xl","\n          "),children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:h("applying")})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{className:"w-5 h-5"}),(0,r.jsxs)("div",{className:"flex flex-col items-start",children:[(0,r.jsx)("span",{children:h("apply_price",{price:P(i)})}),v&&(0,r.jsxs)("span",{className:"text-xs opacity-80 font-normal",children:["+",P(v),x("month_est")]})]})]})}),(0,r.jsxs)("button",{onClick:l,disabled:c,className:"flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-semibold border-2 border-gray-300 text-gray-700 hover:bg-gray-50 transition-all disabled:opacity-50",children:[(0,r.jsx)(C,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:m("dismiss")})]})]}),(0,r.jsxs)("button",{onClick:()=>f(!p),className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,r.jsx)(b,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:h("schedule_later")})]}),p&&(0,r.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200 space-y-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-blue-900",children:x("schedule_price_change")}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-blue-700 mb-1",children:x("date")}),(0,r.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-blue-300 rounded-lg text-sm"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-blue-700 mb-1",children:x("time")}),(0,r.jsx)("input",{type:"time",defaultValue:"09:00",className:"w-full px-3 py-2 border border-blue-300 rounded-lg text-sm"})]})]}),(0,r.jsx)("button",{className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:x("schedule_change")})]}),o&&(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,r.jsx)(C,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,r.jsx)("p",{className:"text-sm text-red-800",children:x("cannot_apply_warning")})]}),j&&!o&&(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,r.jsx)(g,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-orange-900 mb-1",children:x("margin_warning")}),(0,r.jsx)("p",{className:"text-xs text-orange-800",children:null==d?void 0:d.message})]})]})]})}var M=t(5790);let F=(0,m.Z)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);var z=t(4322);let A=(0,m.Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),E=(0,m.Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Z=(0,m.Z)("chart-no-axes-column-increasing",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V9",key:"uvy0l4"}],["path",{d:"M19 21V3",key:"11j9sm"}]]);function K(e){let{recommendedPrice:s,currentPrice:t,strategyDetails:i=[],competitorData:n,productName:l="Produkt",productId:c,confidence:o,onApply:d,onDismiss:h,onRefresh:m,createdAt:g}=e,j=Math.max(0,Math.min(1,o||.5)),[v,N]=(0,a.useState)({}),y=s-t,k=y/t*100,_=e=>{let s=100*j;return s>=90?(0,r.jsx)("span",{className:"strategy-badge excellent",children:"Datenqualit\xe4t: Exzellent"}):s>=80?(0,r.jsx)("span",{className:"strategy-badge excellent",children:"Datenqualit\xe4t: Sehr gut"}):s>=70?(0,r.jsx)("span",{className:"strategy-badge good",children:"Datenqualit\xe4t: Gut"}):(0,r.jsx)("span",{className:"strategy-badge good",children:"Datenqualit\xe4t: Ausreichend"})},D={competitive:{emoji:"\uD83C\uDFEA",title:"Du bist teurer als der Markt",getStory:e=>{var r,a,i;let n=(null===(r=e.competitorData)||void 0===r?void 0:r.avg)||0,l=(null===(i=e.competitorData)||void 0===i?void 0:null===(a=i.prices)||void 0===a?void 0:a.length)||5,c=t-n,o=n>0?(c/n*100).toFixed(0):"0",d=t-s;return c>0?"Wir haben ".concat(l," Wettbewerber analysiert. Der durchschnittliche Preis liegt bei ").concat(P(n),". Du bist ").concat(o,"% teurer als der Durchschnitt. Du solltest den Preis um ").concat(P(Math.abs(d))," ").concat(d>0?"senken":"erh\xf6hen"," um wettbewerbsf\xe4hig zu bleiben."):"Wir haben ".concat(l," Wettbewerber analysiert. Der durchschnittliche Preis liegt bei ").concat(P(n),". Du bist bereits wettbewerbsf\xe4hig positioniert.")},getBasedOn:e=>{var s,t;let r=(null===(t=e.competitorData)||void 0===t?void 0:null===(s=t.prices)||void 0===s?void 0:s.length)||5;return["Echtzeitpreise von ".concat(r," Konkurrenten"),"Aktuelle Marktdaten (heute aktualisiert)","Preisvergleich mit \xe4hnlichen Produkten"]},colorClass:"competitive"},demand:{emoji:"\uD83D\uDCC8",title:"Die Nachfrage steigt stark",getStory:e=>{let s=e.sales||64,t=e.previousSales||54,r=t>0?((s-t)/t*100).toFixed(0):"19";return"In den letzten 7 Tagen hast du ".concat(s," Verk\xe4ufe gemacht (vorher: ").concat(t," Verk\xe4ufe). Das ist ein +").concat(r,"% Wachstum! Wenn die Nachfrage steigt, kannst du h\xf6here Preise durchsetzen.")},getBasedOn:()=>["Deine letzten 30 Tage Verkaufsdaten","Trendanalyse der letzten Woche","Machine-Learning Vorhersage f\xfcr n\xe4chste 7 Tage"],colorClass:"demand"},inventory:{emoji:"\uD83D\uDCE6",title:"Dein Lagerbestand ist niedrig",getStory:e=>{let s=e.stock||45,t=e.daysOfStock||20;return"Mit ".concat(s," Einheiten auf Lager hast du bei aktuellem Tempo noch ").concat(t," Tage Vorrat. Das ist knapp! Du solltest vorsichtig mit Preissenkungen sein.")},getBasedOn:e=>{let s=e.stock||45,t=e.avgDaily||2.25;return["Aktueller Lagerbestand: ".concat(s," St\xfcck"),"Durchschnittlicher Verkauf: ".concat(t.toFixed(1),"/Tag"),"Berechnung basierend auf letzten 7 Tagen Verk\xe4ufen"]},colorClass:"inventory"},cost:{emoji:"\uD83D\uDCB0",title:"Deine Kosten sind stabil",getStory:()=>"Deine Einkaufskosten liegen bei einem stabilen Niveau. Die empfohlene Preis\xe4nderung ber\xfccksichtigt deine aktuellen Margen und stellt sicher, dass du profitabel bleibst.",getBasedOn:()=>["Deine hinterlegten Produktkosten","Aktuelle Marge-Berechnung","Historische Kostenentwicklung"],colorClass:"costs"}},S=e=>{let s=e.recommended_price-t;return{value:s,formatted:P(Math.abs(s)),isIncrease:s>0,isDecrease:s<0}},K=[...i].sort((e,s)=>{let t=Math.abs(S(e).value);return Math.abs(S(s).value)-t}),I=K.map((e,s)=>{let t=S(e),r=e.confidence*(1/K.length),a=t.value*r;return{strategy:e.strategy,impact:t.value,weightedImpact:a,confidence:e.confidence,weight:100*r}});return I.reduce((e,s)=>e+s.weightedImpact,0),(0,r.jsxs)("div",{className:"recommendation-content",children:[(0,r.jsxs)("div",{className:"recommendation-header",children:[(0,r.jsxs)("div",{className:"product-header-row",children:[(0,r.jsxs)("div",{className:"product-info-compact",children:[(0,r.jsx)("h3",{children:l}),c&&(0,r.jsxs)("p",{className:"product-meta",children:["Produkt-ID: ",c]})]}),(0,r.jsxs)("div",{className:"confidence-badge-large",children:[(0,r.jsx)(u,{className:"h-6 w-6"}),(0,r.jsxs)("span",{children:[Math.round(100*j),"% Sicherheit"]})]})]}),(0,r.jsxs)("p",{className:"recommendation-text",children:["Empfohlene Preis",y<0?"senkung":"erh\xf6hung"," um ",Math.abs(k).toFixed(1),"% um wettbewerbsf\xe4hig zu bleiben."]})]}),(d||h||m)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"action-buttons-top",children:[d&&(0,r.jsxs)("button",{className:"action-button-primary",onClick:()=>d(s),children:[(0,r.jsx)(u,{className:"h-5 w-5"}),P(s)," anwenden"]}),h&&(0,r.jsxs)("button",{className:"action-button-secondary",onClick:h,children:[(0,r.jsx)(C,{className:"h-5 w-5"}),"Verwerfen"]}),m&&(0,r.jsxs)("button",{className:"action-button-update",onClick:m,children:[(0,r.jsx)(f.Z,{className:"h-4 w-4"}),"Aktualisieren"]})]}),(0,r.jsxs)("div",{className:"last-updated",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)(b,{className:"h-4 w-4"}),g?new Date(g).toLocaleString("de-DE"):"just now"]}),(0,r.jsx)("span",{className:"update-link",children:"Sp\xe4ter planen"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-between p-6 border-2 rounded-xl",style:{backgroundColor:"#0f172a",borderColor:"#475569",minHeight:"140px"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-slate-500"}),(0,r.jsx)("div",{className:"price-label",style:{color:"#94a3b8"},children:"Aktueller Preis"})]}),(0,r.jsx)("div",{className:"price-amount",style:{fontSize:"36px",color:"#f1f5f9"},children:P(t)})]}),(0,r.jsxs)("div",{className:"relative overflow-hidden rounded-xl border-2 p-6 flex flex-col justify-between",style:{backgroundColor:"#064e3b",borderColor:"#10b981",minHeight:"140px"},children:[(0,r.jsx)("div",{className:"absolute top-4 right-4",children:(0,r.jsx)("div",{className:"px-3 py-1.5 rounded-lg",style:{backgroundColor:"rgba(16, 185, 129, 0.2)",border:"1px solid rgba(16, 185, 129, 0.5)"},children:(0,r.jsx)("span",{className:"text-xs font-bold",style:{color:"#86efac"},children:"⭐ EMPFOHLEN"})})}),(0,r.jsxs)("div",{className:"relative z-10 flex flex-col justify-between h-full",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-400"}),(0,r.jsx)("div",{className:"price-label",style:{color:"#86efac"},children:"Empfohlener Preis"})]}),(0,r.jsx)("div",{className:"price-amount",style:{fontSize:"36px",color:"#86efac"},children:P(s)}),(0,r.jsxs)("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1.5 rounded-lg",style:{backgroundColor:"rgba(16, 185, 129, 0.2)",border:"1px solid rgba(16, 185, 129, 0.3)"},children:[y>0?(0,r.jsx)(M.Z,{className:"w-4 h-4",style:{color:"#86efac"}}):(0,r.jsx)(F,{className:"w-4 h-4",style:{color:"#86efac"}}),(0,r.jsxs)("span",{className:"text-sm font-bold",style:{color:"#86efac"},children:[y>0?"+":"",P(Math.abs(y))," (",y>0?"+":"",Math.abs(k).toFixed(1),"%)"]})]})]})]})]}),(0,r.jsxs)("div",{className:"ml-confidence-section",children:[(0,r.jsxs)("div",{className:"confidence-header",children:[(0,r.jsx)("div",{className:"confidence-icon",children:(0,r.jsx)(u,{className:"h-6 w-6 text-white"})}),(0,r.jsxs)("h3",{className:"confidence-title",children:["Unsere KI ist ",Math.round(100*j),"% sicher"]})]}),(0,r.jsxs)("div",{className:"confidence-progress-wrapper",children:[(0,r.jsxs)("div",{className:"confidence-progress-header",children:[(0,r.jsx)("span",{className:"confidence-progress-label",children:"Sicherheitswert"}),(0,r.jsxs)("span",{className:"confidence-progress-value",children:[Math.round(100*j),"%"]})]}),(0,r.jsx)("div",{className:"confidence-progress-bar-container",style:{maxWidth:"100%",overflow:"hidden"},children:(0,r.jsx)("div",{className:"confidence-progress-bar",style:{width:"".concat(Math.min(Math.max(100*j,0),100),"%"),maxWidth:"100%"}})})]}),(0,r.jsxs)("div",{className:"analysis-factors",children:[(0,r.jsx)("div",{className:"analysis-factors-title",children:"\uD83D\uDCCA Was analysiert unsere KI?"}),(0,r.jsxs)("div",{className:"factors-grid",children:[(0,r.jsxs)("div",{className:"factor-item",children:[(0,r.jsx)(u,{className:"factor-check"}),(0,r.jsx)("span",{children:"Echte Verkaufsdaten aus deinem Shopify-Shop"})]}),(0,r.jsxs)("div",{className:"factor-item",children:[(0,r.jsx)(u,{className:"factor-check"}),(0,r.jsx)("span",{children:"Aktuelle Preise deiner 5-10 wichtigsten Konkurrenten"})]}),(0,r.jsxs)("div",{className:"factor-item",children:[(0,r.jsx)(u,{className:"factor-check"}),(0,r.jsx)("span",{children:"4 spezialisierte Machine-Learning-Modelle"})]}),(0,r.jsxs)("div",{className:"factor-item",children:[(0,r.jsx)(u,{className:"factor-check"}),(0,r.jsx)("span",{children:"Deine eingetragenen Kosten und bisherigen Margen"})]})]}),(0,r.jsxs)("div",{className:"confidence-explanation",children:[(0,r.jsxs)("div",{className:"confidence-explanation-title",children:["\uD83D\uDCA1 Warum genau ",Math.round(100*j),"% Sicherheit?"]}),(0,r.jsx)("p",{className:"confidence-explanation-text",children:"Deine Produkte verkaufen sich bei diesem Preis sehr gut. Konkurrenten haben \xe4hnliche Preise und deine Marge bleibt stabil. Alle Daten deuten auf Erfolg hin!"})]})]})]}),(0,r.jsxs)("div",{className:"why-recommend-section",children:[(0,r.jsxs)("div",{className:"why-recommend-header",children:[(0,r.jsx)("div",{className:"why-recommend-icon",children:(0,r.jsx)(x.Z,{className:"h-5 w-5 text-white"})}),(0,r.jsxs)("h3",{className:"why-recommend-title",children:["\uD83D\uDCA1 Warum empfehlen wir ",P(s),"?"]})]}),(0,r.jsxs)("p",{className:"why-recommend-subtitle",children:["Unsere KI hat ",i.length," wichtige Marktfaktoren analysiert:"]}),(0,r.jsx)("div",{className:"strategy-cards",children:K.map((e,a)=>{let i=D[e.strategy]||{emoji:"\uD83D\uDCCA",title:e.strategy,getStory:()=>e.reasoning||"Keine Details verf\xfcgbar.",getBasedOn:()=>["Daten aus KI-Analyse"],colorClass:"competitive"},l=S(e);return(0,r.jsxs)("div",{className:"strategy-card ".concat(i.colorClass),children:[(0,r.jsxs)("div",{className:"strategy-header",children:[(0,r.jsxs)("div",{className:"strategy-title-row",children:[(0,r.jsx)("div",{className:"strategy-number",children:a+1}),(0,r.jsxs)("div",{className:"strategy-icon-container ".concat(i.colorClass),children:["competitive"===i.colorClass&&(0,r.jsx)(F,{className:"h-4 w-4 text-white"}),"demand"===i.colorClass&&(0,r.jsx)(M.Z,{className:"h-4 w-4 text-white"}),"inventory"===i.colorClass&&(0,r.jsx)(z.Z,{className:"h-4 w-4 text-white"}),"costs"===i.colorClass&&(0,r.jsx)(A,{className:"h-4 w-4 text-white"})]}),(0,r.jsx)("h4",{className:"strategy-title",children:i.title})]}),_(e.confidence)]}),(0,r.jsx)("p",{className:"strategy-text",children:i.getStory({competitorData:n,currentPrice:t,recommendedPrice:s,strategy:e})}),(0,r.jsxs)("div",{className:"strategy-impact ".concat(l.isDecrease?"negative":"positive"),children:[l.isDecrease?(0,r.jsx)(F,{className:"strategy-impact-icon"}):(0,r.jsx)(M.Z,{className:"strategy-impact-icon"}),(0,r.jsxs)("span",{children:["Preisimpact: ",l.isDecrease?"-":"+",l.formatted," ",l.isDecrease?"Senkung empfohlen":"Erh\xf6hung empfohlen"]})]}),(0,r.jsxs)("div",{className:"strategy-details",children:[(0,r.jsxs)("button",{className:"strategy-details-toggle",onClick:()=>N(e=>({...e,[a]:!e[a]})),children:[(0,r.jsx)(E,{className:"h-3 w-3"}),"Basiert auf..."]}),v[a]&&(0,r.jsx)("div",{className:"mt-3 p-3 border",style:{backgroundColor:"#1e293b",borderColor:"#475569"},children:(0,r.jsx)("ul",{className:"list-disc list-inside space-y-1 text-sm",style:{color:"#cbd5e1"},children:i.getBasedOn({competitorData:n,strategy:e,currentPrice:t}).map((e,s)=>(0,r.jsx)("li",{children:e},s))})})]})]},a)})})]}),(0,r.jsxs)("div",{className:"calculation-section",children:[(0,r.jsxs)("div",{className:"calculation-header",children:[(0,r.jsx)("div",{className:"calculation-icon",children:(0,r.jsx)(p,{className:"h-5 w-5 text-white"})}),(0,r.jsxs)("h3",{className:"calculation-title",children:["\uD83E\uDDEE Wie wird ",y<0?"-":"+",P(Math.abs(y))," berechnet?"]})]}),(0,r.jsxs)("div",{className:"calculation-notice",children:[(0,r.jsx)(w,{className:"calculation-notice-icon"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Warum nicht die einfache Summe?"})," Jede Strategie wird basierend auf ihrer",(0,r.jsx)("strong",{children:" Datenqualit\xe4t unterschiedlich stark gewichtet"}),". Faktoren mit exzellenter Datenqualit\xe4t (z.B. Wettbewerbspreise) haben mehr Einfluss als Faktoren mit guter Datenqualit\xe4t (z.B. Nachfrage-Trends). Die gewichtete Berechnung stellt sicher, dass weniger zuverl\xe4ssige Daten nicht zu starken Einfluss haben."]})]}),(0,r.jsxs)("div",{className:"weighted-section",children:[(0,r.jsx)("div",{className:"weighted-header",children:"\uD83D\uDCCA Einzelne Strategien-Empfehlungen:"}),(0,r.jsx)("div",{className:"strategies-list",children:K.map((e,s)=>{let t=S(e),a=D[e.strategy]||{colorClass:"competitive"};return(0,r.jsxs)("div",{className:"strategy-row",children:[(0,r.jsxs)("div",{className:"strategy-row-label",children:["competitive"===a.colorClass&&(0,r.jsx)(F,{className:"strategy-row-icon text-red-500"}),"demand"===a.colorClass&&(0,r.jsx)(M.Z,{className:"strategy-row-icon text-green-500"}),"inventory"===a.colorClass&&(0,r.jsx)(z.Z,{className:"strategy-row-icon text-orange-500"}),"costs"===a.colorClass&&(0,r.jsx)(A,{className:"strategy-row-icon text-blue-500"}),(0,r.jsxs)("span",{children:["\uD83D\uDCCA ",a.title||e.strategy," (",e.confidence>=.9?"Datenqualit\xe4t: Exzellent":e.confidence>=.8?"Datenqualit\xe4t: Sehr gut":"Datenqualit\xe4t: Gut",")"]})]}),(0,r.jsxs)("div",{className:"strategy-row-value ".concat(t.isDecrease?"negative":"positive"),children:[t.isDecrease?"-":"+",t.formatted]})]},s)})})]}),(0,r.jsxs)("div",{className:"weighted-section",children:[(0,r.jsx)("div",{className:"weighted-header",children:"\uD83D\uDCC8 Gewichtete Beitr\xe4ge (Datenqualit\xe4t \xd7 Basis-Gewicht):"}),(0,r.jsx)("div",{className:"weighted-bars",children:I.map((e,s)=>{var t,a,i,n;let l=D[null===(t=K[s])||void 0===t?void 0:t.strategy]||{colorClass:"demand"},c=e.weight/100*100;return(0,r.jsxs)("div",{className:"weighted-bar",children:[(0,r.jsxs)("div",{className:"weighted-bar-header",children:[(0,r.jsx)("span",{className:"weighted-bar-label",children:(null===(a=D[null===(i=K[s])||void 0===i?void 0:i.strategy])||void 0===a?void 0:a.title)||(null===(n=K[s])||void 0===n?void 0:n.strategy)}),(0,r.jsxs)("span",{className:"weighted-bar-value",children:[c.toFixed(1),"% \xd7 Datenqualit\xe4t: ",e.confidence>=.9?"Exzellent":e.confidence>=.8?"Sehr gut":"Gut"," = ",(0,r.jsxs)("strong",{children:[e.weightedImpact>0?"+":"",P(e.weightedImpact)]})]})]}),(0,r.jsx)("div",{className:"weighted-bar-container",children:(0,r.jsx)("div",{className:"weighted-bar-fill ".concat(l.colorClass),style:{width:"".concat(c,"%")}})})]},s)})})]}),(0,r.jsxs)("div",{className:"final-sum-box",children:[(0,r.jsxs)("div",{className:"final-sum-header",children:[(0,r.jsx)(Z,{className:"final-sum-icon"}),(0,r.jsx)("span",{className:"final-sum-label",children:"\uD83D\uDCCA Finale Summe (Gewichteter Durchschnitt):"})]}),(0,r.jsx)("div",{className:"final-sum-calculation",children:"Summe aller gewichteten Beitr\xe4ge"}),(0,r.jsxs)("div",{className:"final-sum-value",children:[y<0?"-":"+",P(Math.abs(y))]}),(0,r.jsxs)("div",{className:"final-sum-percentage",children:["(",y<0?"-":"+",Math.abs(k).toFixed(1),"%)"]})]})]})]})}function I(e){var s,t;let{recommendation:i,onApply:n,onDismiss:l,onRefresh:c}=e,o=N("pricing"),d=N("common");N("market");let[h,m]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),y=i.recommended_price,w=y-i.current_price,k=w/i.current_price*100,_=w>0,C=0===w,M=i.margin_analysis&&!i.margin_analysis.is_safe,F=null===(s=i.warnings)||void 0===s?void 0:s.some(e=>"HIGH"===e.severity||"high"===e.severity),z=void 0!==i.overall_confidence?i.overall_confidence/100:i.confidence,A=Math.max(0,Math.min(1,null!=z?z:.5)),E=function(e){var s;let t=e.recommended_price-e.current_price,r=Math.abs(e.price_change_pct),a=(s=t<0,"Empfohlene ".concat(s?"Preissenkung":"Preiserh\xf6hung"," um ").concat(r.toFixed(1),"%, ").concat(s?"um wettbewerbsf\xe4hig zu bleiben":"aufgrund gestiegener Nachfrage","."));return{headline:a,bulletPoints:function(e){var s,t,r,a;let i=[];if(e.competitor_context){let s=e.competitor_context,t={most_expensive:"Teuerste Option",above_average:"\xdcber dem Durchschnitt",average:"Marktdurchschnitt",below_average:"Unter dem Durchschnitt",cheapest:"G\xfcnstigste Option",unknown:"Unbekannt"}[s.position]||"Unbekannt",r=s.price_diff_pct>0?"".concat(s.price_diff_pct.toFixed(1),"% \xfcber"):"".concat(Math.abs(s.price_diff_pct).toFixed(1),"% unter");i.push("Du liegst aktuell ".concat(r," dem durchschnittlichen Marktpreis (").concat((a=s.avg_price,new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}).format(a)),").")),"unknown"!==t&&i.push("Deine Position: ".concat(t," (").concat(s.competitor_count," Wettbewerber analysiert)."))}if(null===(s=e.strategies)||void 0===s?void 0:s.inventory){let s=e.strategies.inventory;if(s.reasoning.includes("Normaler Bestand")||s.reasoning.includes("normal")){let e=s.reasoning.match(/\((\d+)\)/),t=e?e[1]:"";i.push("Dein Bestand ist normal".concat(t?" (".concat(t," St\xfcck)"):""," – es besteht kein akuter Abverkaufsdruck."))}else s.reasoning.includes("Hoher Bestand")||s.reasoning.includes("hoch")?i.push("Dein Bestand ist hoch – eine Preissenkung k\xf6nnte den Absatz ankurbeln."):(s.reasoning.includes("Niedriger Bestand")||s.reasoning.includes("niedrig"))&&i.push("Dein Bestand ist niedrig – du k\xf6nntest den Preis erh\xf6hen, ohne Absatz zu verlieren.")}if(null===(t=e.strategies)||void 0===t?void 0:t.cost){let s=e.strategies.cost.reasoning.match(/(\d+)%/i),t=s?s[1]:"30";i.push("Die empfohlene Anpassung h\xe4lt deine Zielmarge von ca. ".concat(t,"% ein."))}if(e.margin&&(e.margin.is_safe&&e.margin.margin_pct>=20?i.push("Deine Marge bleibt mit ".concat(e.margin.margin_pct.toFixed(1),"% auf einem gesunden Niveau.")):e.margin.margin_pct<20&&i.push("Achtung: Deine Marge liegt bei ".concat(e.margin.margin_pct.toFixed(1),"% – unter dem empfohlenen Minimum von 20%."))),null===(r=e.strategies)||void 0===r?void 0:r.demand){let s=e.strategies.demand;s.confidence>.6&&!s.reasoning.includes("Zu wenig Daten")&&(s.reasoning.includes("wachsend")||s.reasoning.includes("steigend")?i.push("Die Nachfrage zeigt einen positiven Trend – eine moderate Preiserh\xf6hung k\xf6nnte m\xf6glich sein."):(s.reasoning.includes("r\xfcckl\xe4ufig")||s.reasoning.includes("sinkend"))&&i.push("Die Nachfrage ist r\xfcckl\xe4ufig – eine Preissenkung k\xf6nnte den Absatz stabilisieren."))}return i.length<2&&(i.push("Die Empfehlung basiert auf einer Analyse deiner aktuellen Preislage und Marktvergleichen."),i.push("Der empfohlene Preis optimiert deine Wettbewerbsposition bei gleichbleibender Profitabilit\xe4t.")),i.slice(0,5)}(e),confidence:function(e){var s,t,r;let a=(100*e.confidence).toFixed(1),i=(null===(s=e.ml_predictions)||void 0===s?void 0:s.combined_ml_confidence)?(100*e.ml_predictions.combined_ml_confidence).toFixed(1):null,n=[];e.confidence>=.8?n.push("Hohe Sicherheit"):e.confidence>=.6?n.push("Moderate Sicherheit"):n.push("Eingeschr\xe4nkte Sicherheit"),n.push("".concat(a,"%"));let l=[];return e.competitor_context&&l.push("Wettbewerbsvergleich"),(null===(t=e.strategies)||void 0===t?void 0:t.cost)&&l.push("Kosten"),(null===(r=e.strategies)||void 0===r?void 0:r.inventory)&&l.push("Bestand"),i&&l.push("historische Daten"),l.length>0&&n.push("basierend auf ".concat(l.join(", "))),i&&parseFloat(i)>90&&n.push("und ML-Vorhersage (".concat(i,"%)")),n.join(": ")+"."}(e),insights:function(e){if(e.has_insights){let s=[];return e.competitor_context&&("most_expensive"===e.competitor_context.position&&e.competitor_context.price_diff_pct>30?s.push("Du bist deutlich teurer als der Markt (".concat(e.competitor_context.price_diff_pct.toFixed(1),"% \xfcber Durchschnitt).")):"cheapest"===e.competitor_context.position&&Math.abs(e.competitor_context.price_diff_pct)>20&&s.push("Du bist deutlich g\xfcnstiger als der Markt – eine moderate Preiserh\xf6hung k\xf6nnte m\xf6glich sein.")),e.margin&&!e.margin.is_safe&&s.push("Achtung: Die empfohlene Preis\xe4nderung w\xfcrde deine Marge auf ".concat(e.margin.margin_pct.toFixed(1),"% reduzieren.")),s.join(" ")||"Aktuell liegen keine besonderen Auff\xe4lligkeiten vor."}return"Aktuell liegen keine besonderen Auff\xe4lligkeiten vor. Die Empfehlung basiert auf Standardmodellen und den aktuellen Marktpreisen."}(e)}}({product_title:i.product_title||i.product_name,product_name:i.product_name,current_price:i.current_price,recommended_price:i.recommended_price,price_change_pct:i.price_change_pct,confidence:A,strategies:function(e){if(e.strategy_details&&Array.isArray(e.strategy_details)){let s={};return e.strategy_details.forEach(e=>{s[e.strategy]={price:e.recommended_price,confidence:e.confidence,strategy:e.strategy,reasoning:e.reasoning||""}}),s}let s=e.reasoning;if("object"==typeof s&&(null==s?void 0:s.strategies))return s.strategies}(i),competitor_context:function(e){if(e.competitor_data){var s;let t=e.competitor_data,r=e.recommended_price,a="unknown";return t.avg&&(a=r>=.95*t.max?"most_expensive":r<=1.05*t.min?"cheapest":r>1.1*t.avg?"above_average":r<.9*t.avg?"below_average":"average"),{position:a,avg_price:t.avg||0,min_price:t.min||0,max_price:t.max||0,price_diff_pct:t.avg?(r-t.avg)/t.avg*100:0,competitor_count:(null===(s=t.prices)||void 0===s?void 0:s.length)||0}}}(i),ml_predictions:function(e){let s=e.reasoning;if("object"==typeof s&&(null==s?void 0:s.ml_predictions))return s.ml_predictions}(i),margin:i.margin_analysis?{is_safe:i.margin_analysis.is_safe,margin_pct:i.margin_analysis.margin||0}:void 0,has_insights:i.warnings&&i.warnings.length>0}),Z=E.confidence,I=async()=>{if(n){m(!0);try{await n(y)}catch(e){console.error("Failed to apply price:",e)}finally{m(!1)}}},B=async()=>{if(c){v(!0);try{await c()}catch(e){console.error("Failed to refresh:",e)}finally{v(!1)}}},R=i.product_title||i.product_name||"Product ".concat(i.product_id),L=i.generated_at||i.created_at||new Date().toISOString();return(0,r.jsxs)("div",{className:"shadow-lg border overflow-hidden",style:{backgroundColor:"#1e293b",borderColor:"#475569"},children:[i.strategy_details&&i.strategy_details.length>0?(0,r.jsx)(K,{recommendedPrice:y,currentPrice:i.current_price,strategyDetails:i.strategy_details,competitorData:i.competitor_data,productName:R,productId:i.product_id,confidence:i.confidence,onApply:n?I:void 0,onDismiss:l,onRefresh:c?B:void 0,createdAt:L}):(0,r.jsxs)("div",{className:"p-6 pb-4",style:{background:"linear-gradient(to bottom right, #1e293b, #0f172a)"},children:[(0,r.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-1",style:{color:"#f1f5f9"},children:R}),(0,r.jsxs)("p",{className:"text-xs",style:{color:"#94a3b8"},children:[o("product_id"),": ",i.product_id]})]})}),E.headline&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("p",{className:"text-base font-medium",style:{color:"#f1f5f9"},children:E.headline})}),(0,r.jsxs)("div",{className:"mb-6",style:{backgroundColor:"#0f172a",borderRadius:"12px",padding:"20px",border:"1px solid #334155"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.3)"},children:(0,r.jsx)(u,{className:"h-6 w-6 text-white"})}),(0,r.jsxs)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#f1f5f9",margin:0},children:["Unsere KI ist ",Math.round(100*A),"% sicher"]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#94a3b8"},children:"Sicherheitswert"}),(0,r.jsxs)("span",{style:{fontSize:"18px",fontWeight:"600",color:"#10b981"},children:[Math.round(100*A),"%"]})]}),(0,r.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"#1e293b",borderRadius:"4px",overflow:"hidden"},children:(0,r.jsx)("div",{style:{width:"".concat(100*A,"%"),height:"100%",background:"linear-gradient(90deg, #10b981 0%, #059669 100%)",borderRadius:"4px",transition:"width 0.3s ease"}})})]}),Z&&(0,r.jsx)("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#1e293b",borderRadius:"8px",border:"1px solid #334155"},children:(0,r.jsx)("p",{style:{fontSize:"14px",color:"#cbd5e1",lineHeight:"1.6",margin:0},children:"string"==typeof Z?Z:JSON.stringify(Z)})})]}),(0,r.jsxs)("div",{className:"mb-6",style:{backgroundColor:"#0f172a",borderRadius:"12px",padding:"20px",border:"1px solid #334155"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:(0,r.jsx)(x.Z,{className:"h-6 w-6 text-white"})}),(0,r.jsxs)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#f1f5f9",margin:0},children:["\uD83D\uDCA1 Warum empfehlen wir ",P(y),"?"]})]}),(0,r.jsx)("p",{style:{fontSize:"14px",color:"#cbd5e1",lineHeight:"1.6",marginBottom:"16px"},children:E.headline||E.confidence||"Unsere KI hat mehrere Marktfaktoren analysiert, um diesen Preis zu empfehlen."}),(0,r.jsxs)("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#1e293b",borderRadius:"8px",border:"1px solid #334155"},children:[(0,r.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"#94a3b8",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.05em"},children:"\uD83D\uDCCA Was analysiert unsere KI?"}),(0,r.jsxs)("ul",{style:{listStyle:"none",padding:0,margin:0,display:"flex",flexDirection:"column",gap:"8px"},children:[(0,r.jsxs)("li",{style:{fontSize:"13px",color:"#cbd5e1",display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)(u,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)("span",{children:"Echte Verkaufsdaten aus deinem Shopify-Shop"})]}),(0,r.jsxs)("li",{style:{fontSize:"13px",color:"#cbd5e1",display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)(u,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)("span",{children:"Aktuelle Preise deiner 5-10 wichtigsten Konkurrenten"})]}),(0,r.jsxs)("li",{style:{fontSize:"13px",color:"#cbd5e1",display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)(u,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)("span",{children:"4 spezialisierte Machine-Learning-Modelle"})]}),(0,r.jsxs)("li",{style:{fontSize:"13px",color:"#cbd5e1",display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsx)(u,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)("span",{children:"Deine eingetragenen Kosten und bisherigen Margen"})]})]})]})]}),(0,r.jsxs)("div",{className:"mb-6",style:{backgroundColor:"#0f172a",borderRadius:"12px",padding:"20px",border:"1px solid #334155"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(139, 92, 246, 0.3)"},children:(0,r.jsx)(p,{className:"h-6 w-6 text-white"})}),(0,r.jsxs)("h3",{style:{fontSize:"20px",fontWeight:"700",color:"#f1f5f9",margin:0},children:["\uD83E\uDDEE Wie wird ",w>0?"+":"",P(Math.abs(w))," berechnet?"]})]}),(0,r.jsx)("p",{style:{fontSize:"14px",color:"#cbd5e1",lineHeight:"1.6",marginBottom:"16px"},children:"Der empfohlene Preis basiert auf einer gewichteten Analyse mehrerer Faktoren. Jeder Faktor wird basierend auf seiner Datenqualit\xe4t unterschiedlich stark gewichtet."}),(0,r.jsx)("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#1e293b",borderRadius:"8px",border:"1px solid #334155"},children:(0,r.jsxs)("div",{style:{fontSize:"13px",color:"#cbd5e1",lineHeight:"1.6"},children:[(0,r.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,r.jsx)("strong",{style:{color:"#f1f5f9"},children:"Aktueller Preis:"})," ",P(i.current_price)]}),(0,r.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,r.jsx)("strong",{style:{color:"#f1f5f9"},children:"Empfohlener Preis:"})," ",P(y)]}),(0,r.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,r.jsx)("strong",{style:{color:"#f1f5f9"},children:"Preis\xe4nderung:"}),(0,r.jsxs)("span",{style:{color:w>0?"#10b981":"#f59e0b",marginLeft:"8px"},children:[w>0?"+":"",P(w)," (",w>0?"+":"",Math.abs(k).toFixed(1),"%)"]})]}),i.strategy&&(0,r.jsxs)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #334155"},children:[(0,r.jsx)("strong",{style:{color:"#f1f5f9"},children:"Hauptstrategie:"})," ",i.strategy]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-between p-4 border rounded-lg",style:{backgroundColor:"#0f172a",borderColor:"#475569",minHeight:"120px"},children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide mb-2 font-medium",style:{color:"#94a3b8"},children:o("current")}),(0,r.jsx)("p",{className:"text-3xl font-bold",style:{color:"#f1f5f9"},children:P(i.current_price)})]}),(0,r.jsxs)("div",{className:"flex flex-col justify-between p-4 border-2 rounded-lg",style:{backgroundColor:F?"#7f1d1d":M?"#78350f":"#064e3b",borderColor:F?"#ef4444":M?"#f59e0b":"#10b981",minHeight:"120px"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("p",{className:"text-xs uppercase tracking-wide font-medium",style:{color:F?"#fca5a5":M?"#fbbf24":"#86efac"},children:o("recommended")}),(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{backgroundColor:F?"rgba(252, 165, 165, 0.2)":M?"rgba(251, 191, 36, 0.2)":"rgba(16, 185, 129, 0.2)",color:F?"#fca5a5":M?"#fbbf24":"#86efac"},children:"⭐ EMPFOHLEN"})]}),(0,r.jsx)("p",{className:"text-3xl font-bold",style:{color:F?"#fca5a5":M?"#fbbf24":"#86efac"},children:P(y)}),(0,r.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,r.jsxs)("span",{className:"text-sm font-medium",style:{color:w>0?"#10b981":w<0?"#f59e0b":"#94a3b8"},children:[w>0?"↑":w<0?"↓":"="," ",P(Math.abs(w)),"(",w>0?"+":"",Math.abs(k).toFixed(1),"%)"]})})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-center mb-4",children:C?(0,r.jsx)("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full",style:{backgroundColor:"#334155"},children:(0,r.jsx)("span",{className:"font-medium",style:{color:"#94a3b8"},children:o("no_change")})}):(0,r.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full ".concat(_?"bg-blue-100":"bg-orange-100"),children:[(0,r.jsx)("span",{className:"text-2xl",children:_?"\uD83D\uDCC8":"\uD83D\uDCC9"}),(0,r.jsxs)("span",{className:"text-lg font-bold ".concat(_?"text-blue-700":"text-orange-700"),children:[w>0?"+":"",P(w)]}),(0,r.jsxs)("span",{className:"text-lg font-semibold ".concat(_?"text-blue-600":"text-orange-600"),children:["(",k>0?"+":"",function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"".concat(e>=0?"+":"").concat(e.toFixed(s),"%")}(k),")"]})]})}),(0,r.jsx)("div",{className:"mt-6 px-6",children:(0,r.jsx)(D,{confidence:A,reasoning:E.confidence,compact:!1,confidenceBasis:i.confidence_basis})})]}),(!i.strategy_details||0===i.strategy_details.length)&&(n||l)&&(0,r.jsx)(S,{recommendedPrice:y,onApply:I,onDismiss:l||(()=>{}),isApplying:h,isDisabled:F,marginAnalysis:i.margin_analysis}),F&&(0,r.jsx)("div",{className:"px-6 py-4 border-t",style:{backgroundColor:"#7f1d1d",borderColor:"#ef4444"},children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(g,{className:"w-6 h-6 flex-shrink-0 mt-0.5",style:{color:"#fca5a5"}}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-1",style:{color:"#f1f5f9"},children:o("critical_warning")}),null===(t=i.warnings)||void 0===t?void 0:t.filter(e=>"HIGH"===e.severity||"high"===e.severity).map((e,s)=>(0,r.jsx)("p",{className:"text-sm mb-2",style:{color:"#fca5a5"},children:e.message},s))]})]})}),(0,r.jsxs)("div",{className:"px-6 py-3 border-t flex items-center justify-between",style:{backgroundColor:"#0f172a",borderColor:"#334155"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",style:{color:"#94a3b8"},children:[(0,r.jsx)(b,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:function(e){let s=new Date,t=new Date(e),r=Math.floor((s.getTime()-t.getTime())/6e4);if(r<1)return"just now";if(1===r)return"1 minute ago";if(r<60)return"".concat(r," minutes ago");let a=Math.floor(r/60);if(1===a)return"1 hour ago";if(a<24)return"".concat(a," hours ago");let i=Math.floor(a/24);return 1===i?"1 day ago":"".concat(i," days ago")}(L)})]}),c&&(0,r.jsxs)("button",{onClick:B,disabled:j,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-blue-600 hover:bg-blue-50 transition-colors disabled:opacity-50",children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 ".concat(j?"animate-spin":"")}),(0,r.jsx)("span",{children:d("refresh")})]})]})]})}function B(e){let{productId:s,competitorCount:t,salesDataDays:a,onRunAnalysis:i}=e;return(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,r.jsxs)("h3",{className:"font-bold text-xl text-yellow-800 mb-2",children:["⚠️ Erstmalige Analyse f\xfcr Produkt #",s]}),0===t&&(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg border-l-4 border-orange-400 mb-3",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD0D"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Wettbewerbsanalyse l\xe4uft..."}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Wir sammeln gerade Preisdaten von Wettbewerbern f\xfcr dieses Produkt."}),i&&(0,r.jsx)("button",{onClick:i,className:"text-blue-600 underline hover:text-blue-800 text-sm font-medium mt-2",children:"Jetzt sofort analysieren →"})]})]})}),a<7&&(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg border-l-4 border-blue-400",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC8"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Verkaufsdaten werden gesammelt"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Aktuell: ",(0,r.jsxs)("span",{className:"font-semibold",children:[a," Tage"]}),". Optimal: ",(0,r.jsx)("span",{className:"font-semibold text-green-600",children:"30+ Tage"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Mehr Verkaufsdaten f\xfchren zu pr\xe4ziseren Preisempfehlungen."})]})]})}),t>0&&a>=7&&(0,r.jsx)("div",{className:"bg-green-50 p-4 rounded-lg border-l-4 border-green-400",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"✅"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Datenbasis vorhanden"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Wir haben genug Daten f\xfcr eine erste Analyse. Die Empfehlung wird mit mehr Daten pr\xe4ziser."})]})]})})]})}function R(e){var s,t,i;let{productId:n}=e,[l,m]=(0,a.useState)(null),[u,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),{currentShop:j,isDemoMode:v}=(0,c.L)(),N=async()=>{if(!n)return;let e="string"==typeof n?parseInt(n,10):n;if(isNaN(e)){f("Ung\xfcltige Produkt-ID");return}x(!0),f(null);try{console.log("[LatestRecommendation] \uD83D\uDD04 Generating FRESH recommendation for product:",e);let r=await (0,d.n8)(e);console.log("[LatestRecommendation] ✅ Fresh recommendation generated:",r);let a=r.recommendation||r;if(a){var s,t;console.log("[LatestRecommendation] Recommendation data:",a),a.product_name||(a.product_name=r.product_name||(null===(s=a.product)||void 0===s?void 0:s.title)||a.product_title||"Product ".concat(a.product_id)),!a.current_price&&r.current_price&&(a.current_price=r.current_price);let e=a.reasoning;if("string"==typeof a.reasoning)try{e=JSON.parse(a.reasoning)}catch(s){e=a.reasoning}a.reasoning=e,r.confidence&&(a.feature_confidence=r.confidence,void 0!==r.confidence.overall_confidence&&(a.confidence=r.confidence.overall_confidence/100,a.overall_confidence=r.confidence.overall_confidence,console.log("[LatestRecommendation] Using overall_confidence: ".concat(r.confidence.overall_confidence,"%")))),console.log("[LatestRecommendation] ✅ Setting fresh recommendation with all fields:",a),m(a);let i=null!==(t=a.overall_confidence)&&void 0!==t?t:a.confidence?Math.round(100*a.confidence):0;o.toast.success("Recommendation generiert! \uD83C\uDFAF",{description:"Confidence: ".concat(i,"% | Strategy: ").concat(a.strategy||"N/A")})}else console.log("[LatestRecommendation] No recommendation in response"),m(null),o.toast.error("Keine Recommendation erhalten",{description:"Bitte versuche es erneut"})}catch(e){console.error("[LatestRecommendation] Error generating recommendation:",e),console.error("[LatestRecommendation] Error details:",e.response||e.message),f(e.message||"Fehler beim Generieren der Empfehlung"),m(null),o.toast.error("Fehler beim Generieren der Recommendation",{description:e.message||"Bitte versuche es erneut"})}finally{x(!1)}},y=async()=>{if(!n){alert("Bitte w\xe4hle eine Produkt-ID aus!");return}if(isNaN("string"==typeof n?parseInt(n,10):n)){alert("Ung\xfcltige Produkt-ID");return}g(!0),f(null);try{console.log("[LatestRecommendation] \uD83D\uDD04 Manual refresh requested"),await N()}catch(e){console.error("[LatestRecommendation] Error generating recommendation:",e),f(e.message||"Fehler beim Generieren der Empfehlung"),o.toast.error("Fehler beim Aktualisieren",{description:e.message||"Bitte versuche es erneut"})}finally{g(!1)}},w=async e=>{if(!n){alert("Bitte w\xe4hle eine Produkt-ID aus!");return}if(v){alert("Demo Mode: Preis kann nicht auf Shopify angewendet werden.");return}if(!(null==j?void 0:j.id)){alert("Kein Shop ausgew\xe4hlt. Bitte w\xe4hle einen Shop aus.");return}let s="string"==typeof n?parseInt(n,10):n;if(isNaN(s)){alert("Ung\xfcltige Produkt-ID");return}try{var t;console.log("[LatestRecommendation] Applying price:",{productIdNum:s,price:e,shopId:j.id});let r=await h({product_id:s,recommended_price:e});console.log("[LatestRecommendation] Price applied successfully:",r),o.toast.success("Preis erfolgreich angewendet! ✓",{description:"Neuer Preis: €".concat((null===(t=r.new_price)||void 0===t?void 0:t.toFixed(2))||e.toFixed(2))}),await N()}catch(e){throw console.error("[LatestRecommendation] Error applying price:",e),o.toast.error("Fehler beim Anwenden des Preises",{description:e.message||"Unbekannter Fehler"}),e}};if((0,a.useEffect)(()=>{N()},[n]),u||p)return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsxs)("div",{className:"text-gray-600 text-center",children:[(0,r.jsx)("p",{className:"font-medium",children:"Analysiere aktuelle Marktdaten..."}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Pr\xfcfe Wettbewerber, analysiere 90 Tage Verkaufsdaten..."})]})]});if(b)return(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-red-700 text-sm",children:b}),(0,r.jsx)("button",{onClick:N,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Erneut versuchen"})]});if(!l)return(0,r.jsx)(B,{productId:n,competitorCount:0,salesDataDays:0,onRunAnalysis:y});let k=!l.confidence||l.confidence===-1/0||l.confidence<0||isNaN(l.confidence),_=l.competitor_avg_price?1:0,D=l.sales_7d?7:0;if(k||0===_&&D<7)return(0,r.jsx)(B,{productId:n,competitorCount:_,salesDataDays:D,onRunAnalysis:y});let C=l.reasoning,P="object"==typeof C&&null!==C?C:{},S=P.strategies||{},M=[];M=l.strategy_details&&Array.isArray(l.strategy_details)?l.strategy_details:l.strategyDetails&&Array.isArray(l.strategyDetails)?l.strategyDetails:Object.entries(S).map(e=>{var s;let[t,r]=e;return{strategy:t,recommended_price:(null==r?void 0:r.price)||(null==r?void 0:r.recommended_price)||l.recommended_price,confidence:(null==r?void 0:r.confidence)||.5,reasoning:(null==r?void 0:r.reasoning)||"",competitor_context:(null==r?void 0:r.competitor_context)||(null==r?void 0:null===(s=r.competitive)||void 0===s?void 0:s.competitor_context)}});let F=(null===(s=S.competitive)||void 0===s?void 0:s.competitor_context)||(null===(t=S.competitive)||void 0===t?void 0:t.competitor_context),z=l.competitor_avg_price?{avg:l.competitor_avg_price,min:(null==F?void 0:F.min_price)||.9*l.competitor_avg_price,max:(null==F?void 0:F.max_price)||1.1*l.competitor_avg_price,prices:(null==F?void 0:null===(i=F.sources)||void 0===i?void 0:i.map((e,s)=>({source:e,price:l.competitor_avg_price*(.9+.05*s)})))||[]}:void 0,A=void 0!==l.overall_confidence?l.overall_confidence/100:l.confidence,E={product_id:l.product_id,product_name:l.product_name,current_price:l.current_price,recommended_price:l.recommended_price,price_change:l.recommended_price-l.current_price,price_change_pct:l.price_change_pct,confidence:A,overall_confidence:l.overall_confidence,reasoning:"string"==typeof C?C:P.summary||JSON.stringify(P),strategy_details:M.length>0?M:void 0,competitor_data:z,created_at:l.created_at,generated_at:l.created_at,id:l.id,status:l.status,strategy:l.strategy,ml_confidence:l.ml_confidence,base_confidence:l.base_confidence,applied_at:l.applied_at,applied_price:l.applied_price};return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(I,{recommendation:E,onRefresh:y,onDismiss:()=>{},onApply:w})})}let L=(0,m.Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),W=(0,m.Z)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),V=(0,m.Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),T=(0,m.Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),H=(0,m.Z)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var q=t(1016);let G=e=>"competitor_analysis_".concat(e),U=e=>{try{let s=localStorage.getItem(G(e));if(s){let t=JSON.parse(s);if(Date.now()-(t.cached_at||0)<864e5)return t.data;localStorage.removeItem(G(e))}}catch(e){console.error("Fehler beim Laden aus Cache:",e)}return null},O=(e,s)=>{try{localStorage.setItem(G(e),JSON.stringify({data:s,cached_at:Date.now()}))}catch(e){console.error("Fehler beim Speichern im Cache:",e)}},J=e=>{let s=(e.title||"").toLowerCase(),t=(e.source||"").toLowerCase();return s.includes("gebraucht")||s.includes("used")||t.includes("kleinanzeigen")||t.includes("willhaben")?"used":s.includes("refurbished")||s.includes("general\xfcberholt")?"refurbished":"new"};function Q(e){let{productId:s,currentPrice:t}=e,[i,n]=(0,a.useState)(!1),[l,c]=(0,a.useState)(null),[o,h]=(0,a.useState)(null),[m,x]=(0,a.useState)("all");(0,a.useEffect)(()=>{let e=U(s);e&&c(e)},[s]);let p=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n(!0),h(null);try{let t=await (0,d.Ow)(s,{maxResults:5,forceRefresh:e});c(t),O(s,t)}catch(s){var t,r,a;console.error("[CompetitorAnalysis] Fehler beim Laden:",s);let e="Fehler beim Laden der Wettbewerber-Daten";(null==s?void 0:null===(t=s.response)||void 0===t?void 0:t.status)===404?e="Produkt nicht gefunden. Pr\xfcfe Shop-Auswahl und Produkt-ID.":(null==s?void 0:null===(r=s.response)||void 0===r?void 0:r.status)===429?e="API-Limit erreicht. Bitte sp\xe4ter erneut versuchen.":(null==s?void 0:null===(a=s.response)||void 0===a?void 0:a.status)===500?e="Server-Fehler. Bitte sp\xe4ter erneut versuchen oder Support kontaktieren.":(null==s?void 0:s.message)&&(e=s.message),h(e)}finally{n(!1)}},b=(()=>{if(!l||!l.competitors||0===l.competitors.length)return null;let e=l.competitors.map(e=>e.price),s=Math.min(...e),r=Math.max(...e),a=e.reduce((e,s)=>e+s,0)/e.length,i=l.competitors.filter(e=>"new"===J(e)),n=l.competitors.filter(e=>"used"===J(e)),c=l.competitors.filter(e=>"refurbished"===J(e)),o=i.length>0?Math.min(...i.map(e=>e.price)):null,d=i.length>0?Math.max(...i.map(e=>e.price)):null,h=n.length>0?Math.min(...n.map(e=>e.price)):null;return{minPrice:s,maxPrice:r,avgPrice:a,priceSpread:r-s,yourPriceDiff:t-a,percentAboveAvg:a>0?(t-a)/a*100:0,competitorCount:l.competitors.length,newCount:i.length,usedCount:n.length,refurbishedCount:c.length,newMin:o,newMax:d,usedMin:h}})(),j=(()=>{if(!b)return{label:"Unbekannt",color:"gray",explanation:""};let e=b.priceSpread/b.avgPrice>.4,s=b.competitorCount<3;return e||s?{label:"Eingeschr\xe4nkt zuverl\xe4ssig",color:"orange",explanation:e?"sehr hohe Preisstreuung":"zu wenig vergleichbare Angebote"}:{label:"Zuverl\xe4ssig",color:"green",explanation:""}})(),v=(null==l?void 0:l.competitors)?l.competitors.filter(e=>"all"===m||J(e)===m).sort((e,s)=>e.price-s.price):[],N=(null==l?void 0:l.competitors)?l.competitors.filter(e=>"new"===J(e)).length:0,y=(null==l?void 0:l.competitors)?l.competitors.filter(e=>"refurbished"===J(e)).length:0;return i?(0,r.jsx)("div",{className:"competitor-content",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Suche Wettbewerber-Preise..."})]})}):o?(0,r.jsx)("div",{className:"competitor-content",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[(0,r.jsx)("p",{className:"text-sm font-medium mb-1",children:"⚠️ Fehler"}),(0,r.jsx)("p",{className:"text-sm",children:o})]})}):l?b?(0,r.jsxs)("div",{className:"competitor-content",children:[(0,r.jsxs)("div",{className:"competitor-header",children:[(0,r.jsxs)("div",{className:"competitor-title-row",children:[(0,r.jsx)("div",{className:"competitor-icon-main",children:(0,r.jsx)(W,{className:"h-7 w-7 text-white"})}),(0,r.jsx)("h3",{className:"competitor-title",children:"Wettbewerbsanalyse"})]}),(0,r.jsxs)("div",{className:"competitor-actions",children:[l&&(0,r.jsxs)("button",{className:"btn-refresh",onClick:()=>p(!0),disabled:i,children:[(0,r.jsx)(f.Z,{className:"h-4 w-4"}),"Aktualisieren"]}),(0,r.jsxs)("button",{className:"btn-search",onClick:()=>p(!1),disabled:i,children:[(0,r.jsx)(L,{className:"h-4 w-4"}),"Erneut suchen"]})]})]}),(0,r.jsxs)("div",{className:"price-position-hero",children:[(0,r.jsxs)("div",{className:"price-position-header",children:[(0,r.jsx)("div",{className:"price-position-icon",children:(0,r.jsx)(Z,{className:"h-6 w-6 text-green-600"})}),(0,r.jsx)("h4",{className:"price-position-title",children:"\uD83D\uDCCA Deine Marktposition auf einen Blick"})]}),(0,r.jsxs)("div",{className:"price-scale-container",children:[(0,r.jsxs)("div",{className:"price-scale-labels",children:[(0,r.jsxs)("div",{className:"price-scale-label cheapest",children:[(0,r.jsx)("div",{className:"price-scale-label-icon",children:"\uD83D\uDCB0"}),(0,r.jsx)("div",{className:"price-scale-label-text",children:"G\xfcnstigster"}),(0,r.jsx)("div",{className:"price-scale-value",children:P(b.minPrice)})]}),(0,r.jsxs)("div",{className:"price-scale-label average",children:[(0,r.jsx)("div",{className:"price-scale-label-icon",children:"⚖️"}),(0,r.jsx)("div",{className:"price-scale-label-text",children:"\xd8-Preis"}),(0,r.jsx)("div",{className:"price-scale-value",children:P(b.avgPrice)})]}),(0,r.jsxs)("div",{className:"price-scale-label expensive",children:[(0,r.jsx)("div",{className:"price-scale-label-icon",children:"\uD83D\uDCB8"}),(0,r.jsx)("div",{className:"price-scale-label-text",children:"Teuerster"}),(0,r.jsx)("div",{className:"price-scale-value",children:P(b.maxPrice)})]})]}),(0,r.jsx)("div",{className:"price-scale-bar",children:(0,r.jsxs)("div",{className:"your-price-marker",style:{left:"".concat((()=>{if(!b)return 100;let e=b.maxPrice-b.minPrice;return 0===e?100:Math.min(100,Math.max(0,(t-b.minPrice)/e*100))})(),"%")},children:[(0,r.jsx)("div",{className:"price-marker-pin",children:(0,r.jsx)(V,{className:"price-marker-icon"})}),(0,r.jsx)("div",{className:"price-marker-label",children:"DU"})]})})]}),b.percentAboveAvg>50&&(0,r.jsxs)("div",{className:"price-position-warning",children:[(0,r.jsx)(g,{className:"warning-icon"}),(0,r.jsxs)("div",{className:"warning-content",children:[(0,r.jsxs)("h4",{children:["⚠️ Du bist ",b.percentAboveAvg.toFixed(1),"% teurer als der Durchschnitt"]}),(0,r.jsx)("p",{children:"Kunden werden wahrscheinlich zur Konkurrenz wechseln."})]})]})]}),(0,r.jsxs)("div",{className:"market-stats-grid",children:[(0,r.jsxs)("div",{className:"group relative overflow-hidden rounded-xl bg-slate-800/80 border border-slate-700/50 p-6 hover:border-blue-500/50 transition-all",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 border border-blue-500/20 flex items-center justify-center",children:(0,r.jsx)(T,{className:"w-5 h-5 text-blue-400"})}),(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Gefundene Anbieter"})]}),(0,r.jsx)("span",{className:"text-3xl font-bold text-white",children:b.competitorCount})]}),(0,r.jsxs)("div",{className:"group relative overflow-hidden rounded-xl bg-slate-800/80 border border-slate-700/50 p-6 hover:border-green-500/50 transition-all",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-500/10 border border-green-500/20 flex items-center justify-center",children:(0,r.jsx)(M.Z,{className:"w-5 h-5 text-green-400"})}),(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Durchschnittspreis"})]}),(0,r.jsx)("span",{className:"text-3xl font-bold text-white",children:P(b.avgPrice)})]}),(0,r.jsxs)("div",{className:"group relative overflow-hidden rounded-xl bg-slate-800/80 border border-slate-700/50 p-6 hover:border-purple-500/50 transition-all",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/10 border border-purple-500/20 flex items-center justify-center",children:(0,r.jsx)(H,{className:"w-5 h-5 text-purple-400"})}),(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Preisspanne"})]}),(0,r.jsx)("span",{className:"text-3xl font-bold text-white",children:P(b.priceSpread)})]}),(0,r.jsxs)("div",{className:"group relative overflow-hidden rounded-xl bg-slate-800/80 border border-slate-700/50 p-6 hover:border-orange-500/50 transition-all",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 border border-orange-500/20 flex items-center justify-center",children:(0,r.jsx)(w,{className:"w-5 h-5 text-orange-400"})}),(0,r.jsx)("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Abweichung"})]}),(0,r.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,r.jsxs)("span",{className:"text-3xl font-bold text-orange-400",children:["+",P(b.yourPriceDiff)]}),(0,r.jsx)("span",{className:"text-sm text-slate-400",children:"teurer"})]})]})]}),b.newCount>0&&(0,r.jsx)("div",{className:"product-status-box",children:(0,r.jsxs)("div",{className:"status-row",children:[(0,r.jsx)("span",{className:"status-label",children:"\uD83D\uDCE6 Produktzustand:"}),(0,r.jsxs)("span",{className:"status-value",children:["Neuware: ",b.newCount," Anbieter bieten von"," ",b.newMin&&P(b.newMin)," - ",b.newMax&&P(b.newMax)]})]})}),(0,r.jsxs)("div",{className:"competitors-section-header",children:[(0,r.jsxs)("div",{className:"competitors-section-title",children:[(0,r.jsx)("div",{className:"competitors-section-icon",children:(0,r.jsx)(q.Z,{className:"h-4 w-4 text-white"})}),(0,r.jsxs)("span",{children:["\uD83D\uDD25 ",b.competitorCount," Wettbewerber im Vergleich"]})]}),(0,r.jsxs)("div",{className:"filter-tabs",children:[(0,r.jsx)("button",{className:"filter-tab ".concat("all"===m?"active":""),onClick:()=>x("all"),children:"Alle"}),N>0&&(0,r.jsxs)("button",{className:"filter-tab ".concat("new"===m?"active":""),onClick:()=>x("new"),children:["Nur Neuware (",N,")"]}),y>0&&(0,r.jsxs)("button",{className:"filter-tab ".concat("refurbished"===m?"active":""),onClick:()=>x("refurbished"),children:["Nur Refurbished (",y,")"]})]})]}),(0,r.jsx)("div",{className:"competitors-list",children:v.map((e,s)=>{let a=J(e),i=t-e.price;e.price>0&&e.price;let n=0===s,l=s===v.length-1,c="\uD83D\uDFE2";return c=n?"\uD83D\uDFE2":l?"\uD83D\uDD34":"\uD83D\uDFE1",(0,r.jsxs)("div",{className:"competitor-card group relative overflow-hidden rounded-2xl bg-gradient-to-br from-slate-800/80 to-slate-900/80 border border-slate-700/50 backdrop-blur-sm p-6 hover:border-slate-600/50 hover:shadow-xl hover:shadow-blue-500/10 transition-all duration-300",children:[(0,r.jsx)("div",{className:"absolute -top-20 -right-20 w-40 h-40 rounded-full blur-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 ".concat(n?"bg-green-500/5":l?"bg-red-500/5":"bg-blue-500/5")}),(0,r.jsxs)("div",{className:"absolute top-4 left-4 flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg shadow-lg ".concat(n?"bg-green-500/20 border-2 border-green-500/50 text-green-400":l?"bg-red-500/20 border-2 border-red-500/50 text-red-400":"bg-blue-500/20 border-2 border-blue-500/50 text-blue-400"),children:["#",s+1]}),l&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-md bg-red-500/20 border border-red-500/30 text-xs font-semibold text-red-400",children:"Teuerster"})]}),(0,r.jsx)("div",{className:"pl-16",children:(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,r.jsx)("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center text-2xl shadow-md ".concat(n?"bg-green-500/20 border border-green-500/30":l?"bg-red-500/20 border border-red-500/30":"bg-blue-500/20 border border-blue-500/30"),children:c}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-lg font-bold text-white mb-1",children:e.source||"Unbekannt"}),(0,r.jsx)("p",{className:"text-sm text-slate-400 line-clamp-2 mb-2",children:e.title||"Kein Titel verf\xfcgbar"}),(0,r.jsxs)("div",{className:"competitor-badges",children:[e.rating&&(0,r.jsxs)("span",{className:"competitor-badge badge-rating",children:["⭐ ",e.rating.toFixed(1)," Sterne"]}),"new"===a&&(0,r.jsx)("span",{className:"competitor-badge badge-new",children:"Neuware"}),"refurbished"===a&&(0,r.jsx)("span",{className:"competitor-badge badge-refurbished",children:"Refurbished"}),"used"===a&&(0,r.jsx)("span",{className:"competitor-badge badge-condition",children:"Gebraucht"})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-3xl font-bold text-white mb-1",children:P(e.price)}),(0,r.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-lg ".concat(i<0?"bg-green-500/10 border border-green-500/20":"bg-red-500/10 border border-red-500/20"),children:[i<0?(0,r.jsx)(F,{className:"w-3.5 h-3.5 text-green-400"}):(0,r.jsx)(M.Z,{className:"w-3.5 h-3.5 text-red-400"}),(0,r.jsxs)("span",{className:"text-xs font-bold ".concat(i<0?"text-green-400":"text-red-400"),children:[i<0?"":"+",P(Math.abs(i))]})]})]})]})})]},s)})}),(0,r.jsxs)("div",{className:"rounded-xl bg-slate-800/50 border border-slate-700/50 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("Eingeschr\xe4nkt zuverl\xe4ssig"===j.label?"bg-yellow-500/10 border border-yellow-500/20":"bg-green-500/10 border border-green-500/20"),children:"Eingeschr\xe4nkt zuverl\xe4ssig"===j.label?(0,r.jsx)(w,{className:"w-5 h-5 text-yellow-400"}):(0,r.jsx)(u,{className:"w-5 h-5 text-green-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-white",children:"Datenqualit\xe4t & Aktualit\xe4t"}),(0,r.jsxs)("p",{className:"text-sm text-slate-400",children:["Eingeschr\xe4nkt zuverl\xe4ssig"===j.label?"⚠️ Eingeschr\xe4nkt zuverl\xe4ssig":"✅ Zuverl\xe4ssig"," - Heute aktualisiert"]})]})]}),(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg mb-4 ".concat("Eingeschr\xe4nkt zuverl\xe4ssig"===j.label?"bg-yellow-500/10 border border-yellow-500/20":"bg-green-500/10 border border-green-500/20"),children:[(0,r.jsx)("div",{className:"flex items-center gap-1",children:"Eingeschr\xe4nkt zuverl\xe4ssig"===j.label?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-400"}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-400"}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-600"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-400"}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-400"}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-400"})]})}),(0,r.jsxs)("span",{className:"text-sm font-bold ".concat("Eingeschr\xe4nkt zuverl\xe4ssig"===j.label?"text-yellow-400":"text-green-400"),children:["Qualit\xe4t: ","Eingeschr\xe4nkt zuverl\xe4ssig"===j.label?"Mittel":"Hoch"]})]}),(0,r.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(E,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-slate-300",children:"Die Produkte k\xf6nnten unterschiedliche Varianten sein"})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(E,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-slate-300",children:"Einige Angebote k\xf6nnten nicht mehr verf\xfcgbar sein"})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(E,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-slate-300",children:"Preise k\xf6nnen sich schnell \xe4ndern"})]})]}),(0,r.jsx)("div",{className:"px-4 py-3 rounded-lg bg-slate-900/50 border border-slate-700/30 mb-4",children:(0,r.jsxs)("p",{className:"text-sm text-slate-400",children:[(0,r.jsx)("span",{className:"font-semibold text-slate-300",children:"Das bedeutet:"})," ",j.explanation?"Die Preise zeigen ".concat(j.explanation,". Sie geben einen guten \xdcberblick, sollten aber vor finalen Entscheidungen verifiziert werden."):"Die Preise geben einen guten \xdcberblick und k\xf6nnen f\xfcr Preisentscheidungen verwendet werden."]})}),(0,r.jsxs)("button",{onClick:()=>p(!0),disabled:i,className:"w-full px-4 py-3 rounded-lg bg-blue-600 hover:bg-blue-500 disabled:bg-blue-600/50 disabled:cursor-not-allowed text-white font-semibold text-sm flex items-center justify-center gap-2 transition-colors",children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 ".concat(i?"animate-spin":"")}),(0,r.jsx)("span",{children:"Daten jetzt aktualisieren"})]})]})]}):(0,r.jsx)("div",{className:"competitor-content",children:(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,r.jsx)("p",{children:"Keine Wettbewerber-Daten verf\xfcgbar."})})}):(0,r.jsx)("div",{className:"competitor-content",children:(0,r.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,r.jsx)("p",{className:"mb-2",children:"Noch keine Wettbewerber-Daten geladen."}),(0,r.jsxs)("button",{onClick:()=>p(!1),className:"btn-search",children:[(0,r.jsx)(L,{className:"h-4 w-4"}),"Wettbewerber suchen"]})]})})}let $=(0,m.Z)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),X=(0,m.Z)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);function Y(e){var s,t,a,i;let{marginData:n,compact:l=!1,onAddCosts:c,onEditCosts:o}=e;if(!n.has_cost_data)return(0,r.jsx)("div",{className:"border p-4",style:{backgroundColor:"#1e293b",borderColor:"#475569"},children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center",style:{backgroundColor:"#334155"},children:(0,r.jsx)("span",{className:"text-lg",children:"\uD83D\uDCA1"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold mb-1",style:{color:"#f1f5f9"},children:"Noch pr\xe4ziser mit Kostendaten"}),(0,r.jsxs)("p",{className:"text-xs mb-3",style:{color:"#cbd5e1"},children:["Die Preisempfehlung funktioniert auch ohne Kosten.",(0,r.jsx)("strong",{children:" Mit Kostendaten"})," k\xf6nnen wir zus\xe4tzlich deine ",(0,r.jsx)("strong",{children:"Marge optimieren"})," und sicherstellen, dass du immer profitabel bleibst."]}),c&&(0,r.jsx)("button",{onClick:c,className:"text-xs font-medium transition",style:{color:"#60a5fa",textDecoration:"none"},children:"Kosten hinterlegen (optional)"})]})]})});let d=n.is_above_min_margin?"text-green-600":n.is_above_break_even?"text-orange-600":"text-red-600",h=n.is_above_min_margin?{backgroundColor:"#064e3b",borderColor:"#10b981"}:n.is_above_break_even?{backgroundColor:"#78350f",borderColor:"#f59e0b"}:{backgroundColor:"#7f1d1d",borderColor:"#ef4444"},m=n.is_above_min_margin?(0,r.jsx)(y.Z,{className:"w-5 h-5 text-green-600"}):n.is_above_break_even?(0,r.jsx)(g,{className:"w-5 h-5 text-orange-600"}):(0,r.jsx)(F,{className:"w-5 h-5 text-red-600"});return l?(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 border-2",style:h,children:[m,(0,r.jsxs)("span",{className:"font-semibold ".concat(d),children:[null===(a=n.margin)||void 0===a?void 0:a.percent.toFixed(1),"% Marge"]}),(0,r.jsxs)("span",{className:"text-sm",style:{color:"#94a3b8"},children:["(€",null===(i=n.margin)||void 0===i?void 0:i.euro.toFixed(2),")"]})]}):(0,r.jsxs)("div",{className:"margin-content",children:[(0,r.jsxs)("div",{className:"margin-header",children:[(0,r.jsxs)("h3",{className:"margin-title",children:[(0,r.jsx)(A,{className:"margin-title-icon"}),"Margin-Analyse"]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[n.margin&&(0,r.jsxs)("div",{className:"margin-success-badge",children:[(0,r.jsx)(u,{className:"h-6 w-6",style:{color:"#a7f3d0"}}),(0,r.jsxs)("span",{className:"margin-success-percentage",children:[n.margin.percent.toFixed(1),"%"]})]}),n.has_cost_data&&o&&(0,r.jsxs)("button",{onClick:o,className:"margin-edit-button",title:"Kosten bearbeiten","aria-label":"Kostendaten bearbeiten",children:[(0,r.jsx)($,{className:"h-4 w-4"}),"Bearbeiten"]})]})]}),(0,r.jsxs)("div",{className:"price-grid",children:[(0,r.jsxs)("div",{className:"group relative overflow-hidden rounded-2xl bg-gradient-to-br from-slate-800/80 to-slate-900/80 border border-slate-700/50 backdrop-blur-sm p-6 hover:border-slate-600/50 hover:shadow-xl hover:shadow-purple-500/10 transition-all duration-300",children:[(0,r.jsx)("div",{className:"absolute -top-20 -right-20 w-40 h-40 bg-purple-500/5 rounded-full blur-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),(0,r.jsxs)("div",{className:"relative z-10",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-xl bg-purple-500/10 border border-purple-500/20 mb-4",children:(0,r.jsx)(A,{className:"w-6 h-6 text-purple-400"})}),(0,r.jsx)("div",{className:"price-box-label",children:"Verkaufspreis"}),(0,r.jsxs)("div",{className:"price-box-value",children:["€",(null===(s=n.selling_price)||void 0===s?void 0:s.toFixed(2))||"0.00"]})]})]}),(0,r.jsxs)("div",{className:"group relative overflow-hidden rounded-2xl bg-gradient-to-br from-slate-800/80 to-slate-900/80 border border-slate-700/50 backdrop-blur-sm p-6 hover:border-slate-600/50 hover:shadow-xl hover:shadow-blue-500/10 transition-all duration-300",children:[(0,r.jsx)("div",{className:"absolute -top-20 -right-20 w-40 h-40 bg-blue-500/5 rounded-full blur-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),(0,r.jsxs)("div",{className:"relative z-10",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-xl bg-blue-500/10 border border-blue-500/20 mb-4",children:(0,r.jsx)(X,{className:"w-6 h-6 text-blue-400"})}),(0,r.jsx)("div",{className:"price-box-label",children:"Nettoerl\xf6s"}),(0,r.jsxs)("div",{className:"price-box-value",children:["€",(null===(t=n.net_revenue)||void 0===t?void 0:t.toFixed(2))||"0.00"]}),n.vat_rate&&(0,r.jsxs)("div",{className:"price-box-meta",children:["(nach ",(100*n.vat_rate).toFixed(0),"% MwSt)"]})]})]})]}),n.costs&&(0,r.jsxs)("div",{className:"variable-costs-section",children:[(0,r.jsx)("div",{className:"section-label",children:"Variable Kosten:"}),(0,r.jsxs)("div",{className:"costs-list",children:[(0,r.jsxs)("div",{className:"cost-item",children:[(0,r.jsxs)("div",{className:"cost-item-label",children:[(0,r.jsx)("span",{className:"cost-item-bullet"}),"Einkauf:"]}),(0,r.jsxs)("div",{className:"cost-item-value",children:["€",n.costs.purchase.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"cost-item",children:[(0,r.jsxs)("div",{className:"cost-item-label",children:[(0,r.jsx)("span",{className:"cost-item-bullet"}),"Versand:"]}),(0,r.jsxs)("div",{className:"cost-item-value",children:["€",n.costs.shipping.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"cost-item",children:[(0,r.jsxs)("div",{className:"cost-item-label",children:[(0,r.jsx)("span",{className:"cost-item-bullet"}),"Verpackung:"]}),(0,r.jsxs)("div",{className:"cost-item-value",children:["€",n.costs.packaging.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"cost-item",children:[(0,r.jsxs)("div",{className:"cost-item-label",children:[(0,r.jsx)("span",{className:"cost-item-bullet"}),"Payment Fee",n.payment_provider&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["(",n.payment_provider,")"]}),":"]}),(0,r.jsxs)("div",{className:"cost-item-value",children:["€",n.costs.payment_fee.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"cost-item total-row",children:[(0,r.jsx)("div",{className:"cost-item-label",children:"Gesamt:"}),(0,r.jsxs)("div",{className:"cost-item-value",children:["€",n.costs.total_variable.toFixed(2)]})]})]})]}),n.margin&&(0,r.jsxs)("div",{className:"contribution-margin-box",children:[(0,r.jsxs)("div",{className:"contribution-margin-header",children:[(0,r.jsx)(u,{className:"contribution-check-icon"}),(0,r.jsx)("span",{className:"contribution-label",children:"Deckungsbeitrag I:"})]}),(0,r.jsxs)("div",{className:"contribution-amount",children:["€",n.margin.euro.toFixed(2)]}),(0,r.jsxs)("div",{className:"contribution-percentage",children:["(",n.margin.percent.toFixed(1),"%)"]})]}),(0,r.jsxs)("div",{className:"insights-grid",children:[n.break_even_price&&(0,r.jsxs)("div",{className:"insight-box warning",children:[(0,r.jsxs)("div",{className:"insight-header",children:[(0,r.jsx)(g,{className:"insight-icon warning"}),(0,r.jsx)("span",{className:"insight-label",children:"Break-Even:"})]}),(0,r.jsxs)("div",{className:"insight-value",children:["€",n.break_even_price.toFixed(2)]})]}),n.recommended_min_price&&(0,r.jsxs)("div",{className:"insight-box success",children:[(0,r.jsxs)("div",{className:"insight-header",children:[(0,r.jsx)(u,{className:"insight-icon success"}),(0,r.jsx)("span",{className:"insight-label",children:"Min. empfohlen (20%):"})]}),(0,r.jsxs)("div",{className:"insight-value",children:["€",n.recommended_min_price.toFixed(2)]})]})]}),!n.is_above_break_even&&(0,r.jsxs)("div",{className:"health-banner",style:{background:"linear-gradient(135deg, #fee2e2 0%, #fecaca 100%)",borderColor:"#f87171"},children:[(0,r.jsx)(g,{className:"health-icon",style:{color:"#dc2626"}}),(0,r.jsxs)("div",{className:"health-content",children:[(0,r.jsx)("div",{className:"health-title",style:{color:"#991b1b"},children:"❌ KRITISCH: Unter Break-Even"}),(0,r.jsx)("div",{className:"health-description",style:{color:"#7f1d1d"},children:"Dieser Preis liegt unter deinen Kosten. Du machst Verlust bei jedem Verkauf!"})]})]}),n.is_above_break_even&&!n.is_above_min_margin&&(0,r.jsxs)("div",{className:"health-banner",style:{background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",borderColor:"#fbbf24"},children:[(0,r.jsx)(g,{className:"health-icon",style:{color:"#f59e0b"}}),(0,r.jsxs)("div",{className:"health-content",children:[(0,r.jsx)("div",{className:"health-title",style:{color:"#92400e"},children:"⚠️ NIEDRIGE MARGE"}),(0,r.jsx)("div",{className:"health-description",style:{color:"#78350f"},children:"Marge liegt unter der empfohlenen Mindestmarge von 20%. Ber\xfccksichtige Fixkosten und unerwartete Ausgaben."})]})]}),n.is_above_min_margin&&(0,r.jsxs)("div",{className:"health-banner",children:[(0,r.jsx)(u,{className:"health-icon"}),(0,r.jsxs)("div",{className:"health-content",children:[(0,r.jsx)("div",{className:"health-title",children:"✅ Gesunde Marge"}),(0,r.jsx)("div",{className:"health-description",children:"Marge \xfcber 20% - gute Profitabilit\xe4t! Genug Puffer f\xfcr Fixkosten und Gewinn."})]})]})]})}t(2757);let ee=(0,m.Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),es=(0,m.Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function et(e){let{isOpen:s,onClose:t,productId:i,productTitle:n,currentPrice:l,shopId:c,onSave:o}=e,[h,m]=(0,a.useState)({purchase_cost:0,shipping_cost:0,packaging_cost:0,payment_provider:"stripe",country_code:"DE",category:void 0}),[u,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[b,f]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[N,y]=(0,a.useState)(null),[w,k]=(0,a.useState)(!1),[D,P]=(0,a.useState)(null);(0,a.useEffect)(()=>{s&&i&&S()},[s,i]);let S=async()=>{try{x(!0),y(null);let e=await (0,d.Rd)(i);e?(P({purchase_cost:e.purchase_cost,shipping_cost:e.shipping_cost,packaging_cost:e.packaging_cost,payment_provider:e.payment_provider,country_code:e.country_code,category:e.category}),m({purchase_cost:e.purchase_cost,shipping_cost:e.shipping_cost,packaging_cost:e.packaging_cost,payment_provider:e.payment_provider,country_code:e.country_code,category:e.category}),k(!1)):(P(null),m({purchase_cost:0,shipping_cost:0,packaging_cost:0,payment_provider:"stripe",country_code:"DE",category:void 0}),k(!0),y(null))}catch(s){var e;console.error("Failed to load costs:",s),(null==s?void 0:null===(e=s.response)||void 0===e?void 0:e.status)!==404&&(null==s?void 0:s.status)!==404?y("Fehler beim Laden der Kosten"):(P(null),k(!0),y(null))}finally{x(!1)}};(0,a.useEffect)(()=>{h.category&&F(h.category)},[h.category]);let F=async e=>{try{let s=await (0,d.$m)(e);v(s)}catch(e){console.error("Failed to load category defaults:",e)}},z=async()=>{if(!l||!h.category){y("Bitte w\xe4hle zuerst eine Kategorie");return}x(!0),y(null);try{let e=await (0,d.R5)(l,h.category,h.country_code);m(s=>({...s,purchase_cost:e.estimated_purchase_cost,shipping_cost:e.estimated_shipping_cost,packaging_cost:e.estimated_packaging_cost})),f(!0)}catch(e){console.error("Failed to estimate costs:",e),y("Fehler beim Sch\xe4tzen der Kosten")}finally{x(!1)}},A=async()=>{if(h.purchase_cost<=0){y("Einkaufspreis muss gr\xf6\xdfer als 0 sein");return}g(!0),y(null);try{D?await (0,d._M)(i,h):await (0,d.QJ)(i,h),await o(h),await S(),k(!0)}catch(e){console.error("Failed to save costs:",e),y((null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Fehler beim Speichern der Kosten")}finally{g(!1)}};if(!s)return null;let Z=h.purchase_cost+h.shipping_cost+h.packaging_cost,K=l?(l/1.19-Z)/(l/1.19)*100:0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:t}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between p-6 border-b sticky top-0 bg-white z-10",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Kosten hinterlegen"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:n})]}),(0,r.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition",children:(0,r.jsx)(C,{className:"w-6 h-6"})})]}),N&&(0,r.jsx)("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-800 text-sm",children:N}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[D&&!w&&(0,r.jsxs)("div",{className:"bg-green-50 border-2 border-green-300 rounded-xl p-6 mb-8 shadow-md",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-green-800 mb-1",children:"✅ Gespeicherte Kosten"}),(0,r.jsx)("p",{className:"text-sm text-green-700",children:"Klicke Bearbeiten um Werte anzupassen"})]}),(0,r.jsxs)("button",{onClick:()=>k(!0),className:"px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 flex items-center gap-2 shadow-md transition-all hover:scale-105",title:"Kosten bearbeiten",children:[(0,r.jsx)(ee,{className:"w-4 h-4"}),"Bearbeiten"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Einkauf:"}),(0,r.jsxs)("span",{className:"font-bold ml-2 text-gray-900",children:["€",D.purchase_cost.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Versand:"}),(0,r.jsxs)("span",{className:"font-bold ml-2 text-gray-900",children:["€",D.shipping_cost.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Verpackung:"}),(0,r.jsxs)("span",{className:"font-bold ml-2 text-gray-900",children:["€",D.packaging_cost.toFixed(2)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Payment:"}),(0,r.jsx)("span",{className:"font-bold ml-2 text-gray-900",children:D.payment_provider})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"MwSt:"}),(0,r.jsx)("span",{className:"font-bold ml-2 text-gray-900",children:D.country_code})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Kategorie:"}),(0,r.jsx)("span",{className:"font-bold ml-2 text-gray-900",children:D.category||"N/A"})]})]}),(0,r.jsx)("div",{className:"pt-4 border-t border-green-300",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"font-bold text-gray-900",children:"Gesamt Kosten:"}),(0,r.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:["€",(D.purchase_cost+D.shipping_cost+D.packaging_cost).toFixed(2)]})]})})]}),(w||!D)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kategorie"}),(0,r.jsxs)("select",{value:h.category||"",onChange:e=>m(s=>({...s,category:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Kategorie w\xe4hlen..."}),["fashion","electronics","beauty","home","food"].map(e=>(0,r.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),j&&(0,r.jsx)("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(E,{className:"w-4 h-4 text-blue-600 mt-0.5"}),(0,r.jsxs)("div",{className:"text-sm text-blue-900",children:[(0,r.jsxs)("p",{className:"font-medium",children:["Typisch f\xfcr ",h.category,":"]}),(0,r.jsxs)("p",{children:["Versand: €",j.shipping_estimate.toFixed(2),", Verpackung: €",j.packaging_estimate.toFixed(2)]}),(0,r.jsx)("button",{onClick:()=>{j&&m(e=>({...e,shipping_cost:j.shipping_estimate,packaging_cost:j.packaging_estimate}))},className:"text-blue-600 hover:text-blue-800 font-medium mt-1 underline",children:"→ Werte \xfcbernehmen"})]})]})})]}),l&&h.category&&(0,r.jsxs)("button",{onClick:z,disabled:u,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[u?(0,r.jsx)(es,{className:"w-4 h-4 animate-spin"}):(0,r.jsx)(M.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:u?"Sch\xe4tze...":"Kosten sch\xe4tzen (Verkaufspreis: €".concat(l.toFixed(2),")")})]}),b&&(0,r.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-800",children:"⚠️ Dies sind Sch\xe4tzungen basierend auf Branchendurchschnitten. Bitte mit echten Daten ersetzen!"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCB0 Einkaufspreis (netto) *"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",value:h.purchase_cost||"",onChange:e=>m(s=>({...s,purchase_cost:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00",required:!0}),(0,r.jsx)("span",{className:"absolute right-3 top-2.5 text-gray-500",children:"€"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCE6 Versandkosten (pro St\xfcck)"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",value:h.shipping_cost||"",onChange:e=>m(s=>({...s,shipping_cost:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),(0,r.jsx)("span",{className:"absolute right-3 top-2.5 text-gray-500",children:"€"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCE6 Verpackung (pro St\xfcck)"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"number",step:"0.01",min:"0",value:h.packaging_cost||"",onChange:e=>m(s=>({...s,packaging_cost:parseFloat(e.target.value)||0})),className:"w-full px-4 py-2 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),(0,r.jsx)("span",{className:"absolute right-3 top-2.5 text-gray-500",children:"€"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCB3 Payment Provider"}),(0,r.jsx)("select",{value:h.payment_provider,onChange:e=>m(s=>({...s,payment_provider:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[{value:"stripe",label:"Stripe (2.9% + €0.30)"},{value:"paypal",label:"PayPal (2.49% + €0.35)"},{value:"klarna",label:"Klarna (4.5%)"},{value:"custom",label:"Custom"}].map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83C\uDF0D Land (MwSt)"}),(0,r.jsxs)("select",{value:h.country_code,onChange:e=>m(s=>({...s,country_code:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"DE",children:"Deutschland (19%)"}),(0,r.jsx)("option",{value:"AT",children:"\xd6sterreich (20%)"}),(0,r.jsx)("option",{value:"CH",children:"Schweiz (7.7%)"}),(0,r.jsx)("option",{value:"GB",children:"UK (20%)"}),(0,r.jsx)("option",{value:"US",children:"USA (0%)"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Summe variable Kosten:"}),(0,r.jsxs)("span",{className:"font-semibold",children:["€",Z.toFixed(2)]})]}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Aktueller Preis:"}),(0,r.jsxs)("span",{className:"font-semibold",children:["€",l.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[(0,r.jsx)("span",{children:"Gesch\xe4tzte Marge:"}),(0,r.jsxs)("span",{className:K>=20?"text-green-600":"text-orange-600",children:[K.toFixed(1),"%"]})]})]})]})]})]}),(0,r.jsx)("div",{className:"flex gap-3 p-6 border-t bg-gray-50 sticky bottom-0",children:D&&w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>{D&&m({...D}),k(!1),y(null)},disabled:p,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition disabled:opacity-50 flex items-center justify-center gap-2",children:[(0,r.jsx)(C,{className:"w-4 h-4"}),"Abbrechen"]}),(0,r.jsx)("button",{onClick:A,disabled:p||0===h.purchase_cost,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(es,{className:"w-4 h-4 animate-spin"}),(0,r.jsx)("span",{children:"Speichern..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Speichern"})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:t,disabled:p,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition disabled:opacity-50",children:D?"Schlie\xdfen":"Abbrechen"}),!D&&(0,r.jsx)("button",{onClick:A,disabled:p||0===h.purchase_cost,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(es,{className:"w-4 h-4 animate-spin"}),(0,r.jsx)("span",{children:"Speichern..."})]}):(0,r.jsx)("span",{children:"Kosten erfassen"})})]})})]})})]})}var er=t(5119),ea=t(3067);let ei=(0,m.Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var en=t(3523);function el(){var e;let s=(0,n.usePathname)(),t=(0,n.useSearchParams)().get("product_id"),[o,h]=(0,a.useState)(t?Number(t):1),[m,u]=(0,a.useState)(0),[p,g]=(0,a.useState)(null),[b,f]=(0,a.useState)(!1),[j,v]=(0,a.useState)(""),[N,y]=(0,a.useState)({margin:!1,price:!1,competitor:!1}),[w,k]=(0,a.useState)({margin:!1,price:!1,competitor:!1}),{isDemoMode:_,currentShop:D}=(0,c.L)(),C=e=>{y(s=>({...s,[e]:!s[e]}))};return(0,a.useEffect)(()=>{if(!o||!D){console.log("[RecommendationsPage] Missing productId or currentShop, skipping load");return}(async()=>{try{var e;console.log("[RecommendationsPage] Loading product data:",{productId:o,shopId:D.id,isDemoMode:_});let s=await (0,d.t2)();console.log("[RecommendationsPage] Products received:",s.length,"First ID type:",typeof(null===(e=s[0])||void 0===e?void 0:e.id)),console.log("[RecommendationsPage] Searching for:",o,"Type:",typeof o);let t=s.find(e=>String(e.id)===String(o));if(!t){console.error("[RecommendationsPage] Product not found in current shop",{productId:o,productIdType:typeof o,currentShop:D,productsCount:s.length,availableIds:s.slice(0,5).map(e=>({id:e.id,idType:typeof e.id}))}),g({has_cost_data:!1,error:"Produkt ".concat(o," nicht im aktuellen Shop gefunden. Bitte Shop wechseln oder Produkt-ID pr\xfcfen.")}),u(0),v("Product ".concat(o," (nicht gefunden)"));return}if(console.log("[RecommendationsPage] Product found:",{id:t.id,title:t.title,price:t.price}),u(t.price||0),v(t.title||t.name||"Product ".concat(o)),t.price&&t.price>0)try{let e=await (0,d.ku)(o.toString(),t.price);g(e)}catch(e){g({has_cost_data:!1})}}catch(e){console.error("[RecommendationsPage] Fehler beim Laden der Produktdaten:",e),g({has_cost_data:!1,error:"Fehler beim Laden der Produktdaten."})}})()},[o,null==D?void 0:D.id,_]),(0,a.useEffect)(()=>{let e=e=>{console.log("[RecommendationsPage] Shop switched event received:",e.detail),o&&setTimeout(()=>{(async()=>{try{let e=(await (0,d.t2)()).find(e=>String(e.id)===String(o));e?(console.log("[RecommendationsPage] Product reloaded after shop switch:",{id:e.id,title:e.title,price:e.price}),u(e.price||0),v(e.title||e.name||"Product ".concat(o))):g({has_cost_data:!1,error:"Produkt ".concat(o," nicht im neuen Shop gefunden.")})}catch(e){console.error("[RecommendationsPage] Error reloading product after shop switch:",e)}})()},300)};return window.addEventListener("shop-switched",e),()=>window.removeEventListener("shop-switched",e)},[o]),(0,a.useEffect)(()=>{let e=e=>{e.target.closest(".info-tooltip-button")||k({margin:!1,price:!1,competitor:!1})};if(w.margin||w.price||w.competitor)return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[w]),(0,r.jsxs)("div",{className:"min-h-screen flex recommendations-page",style:{backgroundColor:"#0f172a"},children:[(0,r.jsxs)("aside",{className:"w-80 border-r p-6 overflow-y-auto shadow-sm",style:{background:"linear-gradient(to bottom, #1e293b, #0f172a, #1e293b)",borderColor:"#334155"},children:[(0,r.jsxs)("div",{className:"px-4 pt-6 pb-4 border-b border-gray-800/30",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsxs)("div",{className:"relative group cursor-pointer",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 via-indigo-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/25 transition-all duration-300 group-hover:shadow-xl group-hover:shadow-blue-500/40 group-hover:scale-105",children:(0,r.jsx)("span",{className:"text-xl",children:"\uD83D\uDCA1"})}),(0,r.jsx)("div",{className:"absolute inset-0 bg-blue-500/10 blur-xl rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 -z-10"})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-white tracking-tight leading-none",children:"PriceIQ"}),(0,r.jsx)("p",{className:"text-[10px] font-semibold text-blue-400 uppercase tracking-widest mt-0.5",children:"Pricing Intelligence"})]})]}),(0,r.jsx)("div",{className:"mb-5",children:(0,r.jsx)(l.D,{})})]}),(0,r.jsxs)("nav",{className:"space-y-1 px-2",children:[(0,r.jsx)("div",{className:"px-3 mb-2",children:(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Navigation"})}),(0,r.jsxs)(i.rU,{href:"/",className:"\n              group flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200\n              ".concat("/"===s||"/de"===s||"/en"===s?"bg-blue-500/10 text-blue-400 shadow-sm":"text-gray-400 hover:text-gray-200 hover:bg-slate-800/50","\n            "),children:[(0,r.jsx)("div",{className:"\n              p-1.5 rounded-md transition-colors\n              ".concat("/"===s||"/de"===s||"/en"===s?"bg-blue-500/20":"bg-slate-800/50 group-hover:bg-slate-800","\n            "),children:(0,r.jsx)(er.Z,{className:"w-4 h-4"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Dashboard"}),("/"===s||"/de"===s||"/en"===s)&&(0,r.jsx)("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-blue-400"})]}),(0,r.jsxs)(i.rU,{href:"/products",className:"\n              group flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200\n              ".concat((null==s?void 0:s.includes("/products"))?"bg-blue-500/10 text-blue-400 shadow-sm":"text-gray-400 hover:text-gray-200 hover:bg-slate-800/50","\n            "),children:[(0,r.jsx)("div",{className:"\n              p-1.5 rounded-md transition-colors\n              ".concat((null==s?void 0:s.includes("/products"))?"bg-blue-500/20":"bg-slate-800/50 group-hover:bg-slate-800","\n            "),children:(0,r.jsx)(z.Z,{className:"w-4 h-4"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Produkte"}),(null==s?void 0:s.includes("/products"))&&(0,r.jsx)("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-blue-400"})]}),(0,r.jsxs)(i.rU,{href:"/recommendations",className:"\n              group flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200\n              ".concat((null==s?void 0:s.includes("/recommendations"))?"bg-blue-500/10 text-blue-400 shadow-sm":"text-gray-400 hover:text-gray-200 hover:bg-slate-800/50","\n            "),children:[(0,r.jsx)("div",{className:"\n              p-1.5 rounded-md transition-colors\n              ".concat((null==s?void 0:s.includes("/recommendations"))?"bg-blue-500/20":"bg-slate-800/50 group-hover:bg-slate-800","\n            "),children:(0,r.jsx)(x.Z,{className:"w-4 h-4"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Empfehlungen"}),(null==s?void 0:s.includes("/recommendations"))&&(0,r.jsx)("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-blue-400"})]})]})]}),(0,r.jsx)("main",{className:"flex-1 overflow-y-auto",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-8 py-8",children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"recommendations-header",children:[(0,r.jsxs)("div",{className:"header-icon-container",children:[(0,r.jsx)("div",{className:"header-main-icon",children:(0,r.jsx)(Z,{className:"h-10 w-10 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"header-title",children:"Produkt-Analysen"}),(0,r.jsx)("p",{className:"header-subtitle",children:"Vollst\xe4ndige Analyse f\xfcr optimale Preisentscheidungen"})]})]}),(0,r.jsxs)("div",{className:"product-info-card",children:[(0,r.jsx)("div",{className:"product-icon",children:(0,r.jsx)(z.Z,{className:"h-8 w-8 text-white"})}),(0,r.jsxs)("div",{className:"product-details",children:[(0,r.jsx)("h2",{children:j||"Produkt ".concat(o)}),m>0&&(0,r.jsxs)("p",{className:"product-price-display",children:["Aktueller Preis: ",(0,r.jsxs)("strong",{children:[m.toFixed(2)," €"]})]})]}),(0,r.jsxs)(i.rU,{href:"/",className:"back-button ml-auto",children:[(0,r.jsx)(ea.Z,{className:"h-4 w-4"}),"Zur\xfcck"]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[m>0&&p&&(0,r.jsxs)("div",{className:"collapsible-card",children:[(0,r.jsxs)("div",{className:"collapsible-header",onClick:()=>C("margin"),children:[(0,r.jsx)("div",{className:"section-icon icon-margin",children:(0,r.jsx)(A,{className:"h-8 w-8 text-white"})}),(0,r.jsxs)("div",{className:"section-content",children:[(0,r.jsxs)("h3",{className:"section-title",children:["Margen-Analyse",(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),k(e=>({...e,margin:!e.margin}))},className:"info-tooltip-button",children:[(0,r.jsx)(E,{className:"w-4 h-4 transition-colors",style:{color:"#94a3b8"}}),w.margin&&(0,r.jsxs)("div",{className:"info-tooltip-content",children:[(0,r.jsx)("h4",{children:"Was passiert hier?"}),(0,r.jsx)("p",{children:"Die Margen-Analyse zeigt dir, ob dein aktueller Preis \xfcber deinen Kosten liegt und wie viel Gewinn du pro Verkauf machst."}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Wichtig:"})," Bevor du Preise \xe4nderst, solltest du immer pr\xfcfen, dass du nicht unter deine Kosten verkaufst!"]}),(0,r.jsx)("p",{children:"Hier kannst du auch Kosten f\xfcr dein Produkt hinterlegen (Einkaufspreis, Versand, Verpackung, etc.)."})]})]})]}),(0,r.jsx)("p",{className:"section-subtitle",children:"Pr\xfcfe deine Kosten und Margen vor Preis\xe4nderungen"})]}),N.margin?(0,r.jsx)(ei,{className:"chevron-arrow"}):(0,r.jsx)(en.Z,{className:"chevron-arrow"})]}),N.margin&&(0,r.jsx)("div",{className:"px-8 pb-6",children:(0,r.jsx)(Y,{marginData:p||{has_cost_data:!1},onAddCosts:()=>f(!0),onEditCosts:()=>f(!0)})})]}),(0,r.jsxs)("div",{className:"collapsible-card",children:[(0,r.jsxs)("div",{className:"collapsible-header",onClick:()=>C("price"),children:[(0,r.jsx)("div",{className:"section-icon icon-recommendation",children:(0,r.jsx)(A,{className:"h-8 w-8 text-white"})}),(0,r.jsxs)("div",{className:"section-content",children:[(0,r.jsxs)("h3",{className:"section-title",children:["Preisempfehlung",(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),k(e=>({...e,price:!e.price}))},className:"info-tooltip-button",children:[(0,r.jsx)(E,{className:"w-4 h-4 transition-colors",style:{color:"#94a3b8"}}),w.price&&(0,r.jsxs)("div",{className:"info-tooltip-content",children:[(0,r.jsx)("h4",{children:"Was passiert hier?"}),(0,r.jsx)("p",{children:"Unsere KI analysiert verschiedene Faktoren wie Nachfrage, Lagerbestand, Wettbewerbspreise und deine Kosten, um dir eine optimale Preisempfehlung zu geben."}),(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"Die Empfehlung ber\xfccksichtigt:"})}),(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:"Verkaufsdaten der letzten 30 Tage"}),(0,r.jsx)("li",{children:"Aktuelle Preise deiner Konkurrenten"}),(0,r.jsx)("li",{children:"Deine Lagerbest\xe4nde"}),(0,r.jsx)("li",{children:"Deine Kosten und Margen"})]}),(0,r.jsx)("p",{children:"Du kannst die Empfehlung direkt anwenden oder erst die Details ansehen."})]})]})]}),(0,r.jsx)("p",{className:"section-subtitle",children:"KI-basierte Preisempfehlung basierend auf Marktdaten"})]}),N.price?(0,r.jsx)(ei,{className:"chevron-arrow"}):(0,r.jsx)(en.Z,{className:"chevron-arrow"})]}),N.price&&(0,r.jsx)("div",{className:"px-8 pb-6",children:(0,r.jsx)("div",{className:"rounded-lg border p-6 transition-all duration-300 ease-in-out",style:{backgroundColor:"#1e293b",borderColor:"#475569"},children:(0,r.jsx)(R,{productId:o})})})]}),m>0&&(0,r.jsxs)("div",{className:"collapsible-card",children:[(0,r.jsxs)("div",{className:"collapsible-header",onClick:()=>C("competitor"),children:[(0,r.jsx)("div",{className:"section-icon icon-competitor",children:(0,r.jsx)(W,{className:"h-8 w-8 text-white"})}),(0,r.jsxs)("div",{className:"section-content",children:[(0,r.jsxs)("h3",{className:"section-title",children:["Wettbewerbsanalyse",(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),k(e=>({...e,competitor:!e.competitor}))},className:"info-tooltip-button",children:[(0,r.jsx)(E,{className:"w-4 h-4 transition-colors",style:{color:"#94a3b8"}}),w.competitor&&(0,r.jsxs)("div",{className:"info-tooltip-content",children:[(0,r.jsx)("h4",{children:"Was passiert hier?"}),(0,r.jsx)("p",{children:"Die Wettbewerbsanalyse zeigt dir, wie dein Preis im Vergleich zu anderen Anbietern steht."}),(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"Du siehst:"})}),(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:"Preise deiner Konkurrenten (Neuware, Gebraucht, etc.)"}),(0,r.jsx)("li",{children:"Deine Marktposition (g\xfcnstigster, teuerster, Durchschnitt)"}),(0,r.jsx)("li",{children:"Durchschnittspreis und Preisspanne"}),(0,r.jsx)("li",{children:"Datenqualit\xe4t der Analyse"})]}),(0,r.jsx)("p",{children:"Nutze diese Informationen, um deine Preise strategisch anzupassen."})]})]})]}),(0,r.jsx)("p",{className:"section-subtitle",children:"Vergleiche deine Preise mit der Konkurrenz"})]}),N.competitor?(0,r.jsx)(ei,{className:"chevron-arrow"}):(0,r.jsx)(en.Z,{className:"chevron-arrow"})]}),N.competitor&&(0,r.jsx)("div",{className:"px-8 pb-6",children:(0,r.jsx)("div",{className:"rounded-lg border p-6 transition-all duration-300 ease-in-out",style:{backgroundColor:"#1e293b",borderColor:"#475569"},children:(0,r.jsx)(Q,{productId:o,currentPrice:m})})})]})]})]})})}),(0,r.jsx)(et,{isOpen:b,onClose:()=>f(!1),productId:o.toString(),productTitle:j||"Product ".concat(o),currentPrice:m,shopId:(null==D?void 0:null===(e=D.id)||void 0===e?void 0:e.toString())||"demo",onSave:async e=>{try{if(await (0,d.QJ)(o.toString(),e),f(!1),m>0){let e=await (0,d.ku)(o.toString(),m);g(e)}}catch(e){throw console.error("Fehler beim Speichern der Kosten:",e),e}}})]})}function ec(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen p-8",children:"Lade..."}),children:(0,r.jsx)(el,{})})}},2757:function(){}},function(e){e.O(0,[292,869,424,75,971,119,171,744],function(){return e(e.s=1702)}),_N_E=e.O()}]);